---
title: "Media advocacy promotes in-person and online audiences' engagement with social justice cause through empathy"
shorttitle: "Media advocacy and audience engagement"
author:
  - name: Joshua L. Schlichting
    orcid: 0000-0001-8239-5197
    email: schlichj@mcmaster.ca
    roles:
      - conceptualization
      - methodology
      - investigation
      - software
      - visualization
      - data curation
      - formal analysis  
      - validation
      - writing
    affiliations:
      - id: id1
        name: "McMaster University"
        department: Department of Psychology, Neuroscience & Behaviour
        address: 1280 Main Street West
        city: Hamilton
        region: ON
        country: Canada
        postal-code: L8S 4K1
  - name: Lauren K. Fink
    orcid: 0000-0001-6699-750X
    corresponding: true
    roles:
      - conceptualization
      - methodology
      - investigation
      - funding acquisition
      - project administration
      - resources
      - supervision
      - editing
    affiliations: 
      - ref: id1
blank-lines-above-author-note: 2
author-note:
  # Disclosures condensed to one paragraph, but you can start a field with two line breaks to break them up: \n\nNew Paragraph
  disclosures:
    study-registration: "The design, hypotheses, and analysis plan for study 2 were preregistered; see TODO."
    data-sharing: "Data and code from this manuscript can be accessed at TODO."
    related-report: "This article is based on the thesis completed by Schlichting (2025)."
    conflict-of-interest: The authors have no conflicts of interest to disclose.
    financial-support: "JLS was supported by a scholarship of the German Academic Exchange Service (DAAD)."
    gratitude: "The authors would like to thank Allen Otte, John Lane, and Wojciech Lorenc for their artistic contribution, Innocence Canada for the provision of insights and materials, the LIVELab and BEAT Lab team for their crucial support in facilitating the live event, and Laurel Trainor and John Iversen for thoughtful comments on the project."
abstract: "Fighting systemic social injustices, such as wrongful imprisonment, requires broad public support. A promising means to mobilize support may be artistic media, which have a wide reach. Some media advocacy has been empirically evaluated and has shown tangible effects on audiences’ attitudes and behaviour. However, previous studies differ vastly in the media, reception contexts, and psychological variables that are evaluated. This diversity requires experimental comparison to identify the necessary and facilitating ingredients for media to successfully mobilize support for social justice causes. Across two studies, we evaluated how a narrative documentary film and an abstract music performance advocate for wrongfully imprisoned persons. We assessed three self-reported affective and cognitive variables before and after seeing the film and the performance, as well as behaviour in support of a charity fighting wrongful imprisonment, among audience members in the concert hall (Study 1: N = 62) and at home viewing a stream (Study 1: N = 32; Study 2: N = 200). Audiences reported the largest increases in relationship closeness with a wrongfully imprisoned person, followed by empathic concern, with the smallest increases in problem awareness. The film had larger effects on closeness and empathy than the performance, corroborating previous research highlighting the relevance of narration for media advocacy. Empathic concern predicted intentions to support a related charity, and thus seems crucial to mobilizing support for social justice causes. There were no significant differences between audiences in the concert hall and at home, implying that the media’s mobilizing effects generalize across spatial and temporal contexts."
keywords: [music, film, social justice, prosocial, empathy]
impact-statement: ~
floatsintext: true
numbered-lines: true
bibliography: 
  - innocentsref.bib
  - r-references.bib
suppress-title-page: false
link-citations: true
# TODO set to true for peer review. Masks author info & references that appear in the masked-citations list
mask: false
masked-citations:
  - schneider2012cattell
  - schneider2015intelligence
# If true, adds today's date below author affiliations. If text, can be any value.
# This is not standard APA format, but it is convenient.
# Works with docx, html, and typst. 
draft-date: false
lang: en
language:
  citation-last-author-separator: "and"
  citation-masked-author: "Masked Citation"
  citation-masked-date: "n.d."
  citation-masked-title: "Masked Title"
  email: "Email"
  title-block-author-note: "Author Note"
  title-block-correspondence-note: "Correspondence concerning this article should be addressed to"
  title-block-role-introduction: "Author roles were classified using the Contributor Role Taxonomy (CRediT; [credit.niso.org](https://credit.niso.org)) as follows:"
  title-impact-statement: "Impact Statement"
format:
  apaquarto-docx: 
    toc: false
  apaquarto-pdf:
    documentmode: man # Can be jou (journal), man (manuscript), stu (student), or doc (document)
    keep-tex: true
---

```{r}
#| label: setup
#| include: false

# clear environment
rm(list=ls())

# load/install required packages
require(pacman)
p_load('quarto', 'tidyverse', 'ggplot2', 'ggpubr', 'ggridges', 'ggsignif', 'ggnewscale', 'here', 'lmerTest', 'car', 'psych', 'performance', 'corrplot', 'sjPlot', 'papaja', 'stringdist', 'wordcloud', 'MASS', 'pwr', 'effsize', 'png', 'grid', 'ltm', 'conflicted', 'flextable', 'ftExtra', 'knitr', 'tinytable', 'waffle', 'webshot2', 'Hmisc')

# set preferences in case of command conflicts between loaded packages
conflicts_prefer(dplyr::select, .quiet = TRUE)
conflicts_prefer(dplyr::filter, .quiet = TRUE)
conflicts_prefer(flextable::separate_header, .quiet = TRUE)
conflicts_prefer(lmerTest::lmer, .quiet = TRUE)

# update R references
# r_refs("r-references.bib") 

# load custom functions
source(here("src/LMMfunctions.R"), local = knitr::knit_global()) 

# sessionInfo()

#### PLOTTING PARAMETERS ###

# set custom colour palette
ordermedium_cols <- c("#FFB000", "#661BFF", "#1D95FF", "#FFEB00") # "F-P: Film", "F-P: Performance", "P-F: Performance", "P-F: Film"  
# NeuroMusic palette: "#6472FF", "#FE6100", "#FFB000", "#8ECEFE"
medium_cols <- ordermedium_cols[c(1, 2)] # Film, Performance

# load icons
icon_close <- readPNG(here("images/Innocents_Icon_Closeness.png"))
icon_empath <- readPNG(here("images/Innocents_Icon_Empathy.png"))
icon_aware <- readPNG(here("images/Innocents_Icon_Awareness.png"))
icon_intent <- readPNG(here("images/Innocents_Icon_Intention.png"))
icon_behav <- readPNG(here("images/Innocents_Icon_Behaviour.png"))
```

```{r}
#| label: prepstudy1
#| include: false

# load study 1 data
here::i_am("Innocents_Prosociality_Manuscript.qmd") # find project root
study1_df_deident <- read_csv(here("data/innocents_df_deident.csv")) # load deident df, then calculate indices in here

#### Exclude responses that lack variance ###
# TODO discuss with Lauren whether to check variance per instrument or per survey page
# define mapping of variables to scales to instruments
study1_instruments <- list(
  base_ios = list(
    base_ios = c("base_ios_allen", "base_ios_john", "base_ios_anna", "base_ios_inperson", "base_ios_remote")),
  base_anna_empathy = list(
    base_anna_empathic_concern = c("base_ec1", "base_ec2", "base_ec3", "base_ec4", "base_ec5", "base_ec6"),
    base_anna_personal_distress = c("base_pd1", "base_pd2", "base_pd3", "base_pd4", "base_pd5", "base_pd6", "base_pd7", "base_pd8")),
  base_namtpb = list(
    base_problem_awareness = c("base_nam1", "base_nam2", "base_nam3", "base_nam4"),
    base_ascribed_responsibility = c("base_nam5", "base_nam6", "base_nam7", "base_nam8"),
    base_personal_norm = c("base_nam9", "base_nam10", "base_nam11", "base_nam12"),
    base_attitude = c("base_tpb1", "base_tpb2", "base_tpb3", "base_tpb4"),
    base_subjective_norm = c("base_tpb5", "base_tpb6", "base_tpb7", "base_tpb8"),
    base_behavioural_control = c("base_tpb9", "base_tpb10", "base_tpb11", "base_tpb12"),
    base_behavioural_intention = c("base_tpb13", "base_tpb14", "base_tpb15")),
  base_affect = list(
    base_affect = grep("base_emotion", colnames(study1_df_deident), value = TRUE)),
  perfo_affect = list(
    perfo_affect = grep("perfo_emotion", colnames(study1_df_deident), value = TRUE)),
  perfo_engagement = list(
    perfo_engagement = c("perfo_enjoy", "perfo_interest", "perfo_moved", "perfo_insight", "perfo_concentration", "perfo_chills", "perfo_tears", "perfo_reengage")),
  perfo_ios = list(
    perfo_ios = c("perfo_ios_allen", "perfo_ios_john", "perfo_ios_anna", "perfo_ios_inperson", "perfo_ios_remote")),
  perfo_anna_empathy = list(
    perfo_anna_empathic_concern = c("perfo_ec1", "perfo_ec2", "perfo_ec3", "perfo_ec4", "perfo_ec5", "perfo_ec6"),
    perfo_anna_personal_distress = c("perfo_pd1", "perfo_pd2", "perfo_pd3", "perfo_pd4", "perfo_pd5", "perfo_pd6", "perfo_pd7", "perfo_pd8")),
  perfo_namtpb = list(
    perfo_problem_awareness = c("perfo_nam1", "perfo_nam2", "perfo_nam3", "perfo_nam4"),
    perfo_behavioural_intention = c("perfo_tpb13", "perfo_tpb14", "perfo_tpb15")),
  docu_affect = list(
    docu_affect = grep("docu_emotion", colnames(study1_df_deident), value = TRUE)),
  docu_engagement = list(
    docu_engagement = c("docu_enjoy", "docu_interest", "docu_moved", "docu_insight", "docu_concentration", "docu_chills", "docu_tears", "docu_reengage")),
  docu_ios = list(
    docu_ios = c("docu_ios_allen", "docu_ios_john", "docu_ios_anna", "docu_ios_inperson", "docu_ios_remote")),
  docu_anna_empathy = list(
    docu_anna_empathic_concern = c("docu_ec1", "docu_ec2", "docu_ec3", "docu_ec4", "docu_ec5", "docu_ec6"),
    docu_anna_personal_distress = c("docu_pd1", "docu_pd2", "docu_pd3", "docu_pd4", "docu_pd5", "docu_pd6", "docu_pd7", "docu_pd8")),
  docu_namtpb = list(
    docu_problem_awareness = c("docu_nam1", "docu_nam2", "docu_nam3", "docu_nam4"),
    docu_behavioural_intention = c("docu_tpb13", "docu_tpb14", "docu_tpb15")),
  post_namtpb = list(
    post_ascribed_responsibility = c("post_nam5", "post_nam6", "post_nam7", "post_nam8"),
    post_personal_norm = c("post_nam9", "post_nam10", "post_nam11", "post_nam12"),
    post_attitude = c("post_tpb1", "post_tpb2", "post_tpb3", "post_tpb4"),
    post_subjective_norm = c("post_tpb5", "post_tpb6", "post_tpb7", "post_tpb8"),
    post_behavioural_control = c("post_tpb9", "post_tpb10", "post_tpb11", "post_tpb12")),
  demo_openness = list(
    demo_openness = grep("open", colnames(study1_df_deident), value = TRUE)),
  demo_trait_empathy = list(
    trait_empathic_concern = c("iri2", "iri4", "iri9", "iri14", "iri18", "iri20", "iri22"),
    trait_personal_distress = c("iri6", "iri10", "iri13", "iri17", "iri19", "iri24", "iri27")
  )
)

#### CHECK FOR SUFFICIENT VARIANCE ACROSS ITEMS OF ONE INSTRUMENT ###
variance_for_manyitems <- 2
variance_for_fewitems <- 1
threshold_fewormanyitems <- 10

study1_df_variance <- study1_df_deident %>% # make copy of dataframe
  rename_with(
    .fn = ~ str_replace(., "^final_", "post_"), # rename final_ to post_ for consistency
    .cols = starts_with("final_")
  )

study1_total_instrument_observations <- 0 # counter for total instruments checked across participants
study1_novariance_observations <- 0 # counter for instruments with lack of variance

# iterate over instruments
for (instrument in names(study1_instruments)) {
  # get all item columns of the instrument
  items <- c()
  for (scale in names(study1_instruments[[instrument]])) {
    items <- c(items, study1_instruments[[instrument]][[scale]])
  }
  
  # count unique values and store in new column
  unique_column <- paste0(instrument, "_unique") # name of the new column that stores the number of unique values
  study1_df_variance <- study1_df_variance %>%
    rowwise() %>%
    mutate(!!unique_column := n_distinct(c_across(all_of(items)), na.rm = TRUE)) %>%
    ungroup()
  
  # count number of observations that lack variances
  cutoff <- ifelse(length(items) > threshold_fewormanyitems, variance_for_manyitems, variance_for_fewitems) # define what constitutes a lack of variance depending on the number of items in the instrument
  
  total <- sum(study1_df_variance[[unique_column]] > 0 & !is.na(study1_df_variance[[unique_column]])) # count total observations per instrument
  novariance <- sum(study1_df_variance[[unique_column]] > 0 & study1_df_variance[[unique_column]] <= cutoff, na.rm = TRUE) # count cases where unique values are below cutoff
  
  study1_total_instrument_observations = study1_total_instrument_observations + total # update counters
  study1_novariance_observations = study1_novariance_observations + novariance
}

rm(instrument, items, scale, unique_column, cutoff, total, novariance, study1_df_deident)

#### RECODE REVERSE-CODED ITEMS ###

study1_df_recoded <- study1_df_variance %>%
  rowwise() %>%
  mutate(across(.cols = c(age, caffeine, liking, income, education, politics),
                .fns = ~ case_match(.x, -1 ~ NA, -9 ~ NA, .default = .x)), # recode "prefer not to answer" as NA
         across(.cols = c(base_nam3, base_tpb11, perfo_nam3, docu_nam3, post_tpb11),
                .fns = ~ 8 - .x),
         across(.cols = c(open1, open6, open11, iri4, iri13, iri14, iri18, iri19),
                .fns = ~ 6 - .x),
         mailing_presubsribed = ifelse(mailing == -9, 1, 0),
         mailing = replace(mailing, mailing == -9, NA_real_), 
         mailing = replace(mailing, mailing == -1, 0), # coding error between inperson and online surveys
         flyer = replace(flyer, is.na(flyer), 0)) %>% # for online participants, those who did not click the resource had NA here; set to 0
  ungroup() 

rm(study1_df_variance)

#### cALCULATE CONSTRUCT SCORES IF AT LEAST 80% OF ITEMS HAVE BEEN ANSWERED AND IF THERE IS SUFFICIENT VARIANCE ###

study1_df <- study1_df_recoded %>%
  rowwise() %>%
  mutate(
    # calculate affect scales
    base_pleasure = base_emotion3 - base_emotion6,
    base_awake = base_emotion5 - base_emotion1,
    base_tense = base_emotion2 - base_emotion4,
    perfo_pleasure = perfo_emotion3 - perfo_emotion6,
    perfo_awake = perfo_emotion5 - perfo_emotion1,
    perfo_tense = perfo_emotion2 - perfo_emotion4,
    docu_pleasure = docu_emotion3 - docu_emotion6,
    docu_awake = docu_emotion5 - docu_emotion1,
    docu_tense = docu_emotion2 - docu_emotion4
  ) %>%
  ungroup()

# iterate over instruments
for (instrument in names(study1_instruments)) {
  if (instrument %in% c("base_ios", "base_affect", "perfo_ios", "perfo_affect", "perfo_engagement", "docu_ios", "docu_affect", "docu_engagement")) next # skip instruments that should not be averaged
  
  unique_column <- paste0(instrument, "_unique") # name of the column that stores the number of unique values
  
  # get all item columns of the instrument
  instrument_items <- c()
  for (scale in names(study1_instruments[[instrument]])) {
    instrument_items <- c(instrument_items, study1_instruments[[instrument]][[scale]])
  }
  
  cutoff <- ifelse(length(instrument_items) > threshold_fewormanyitems, variance_for_manyitems, variance_for_fewitems) # define what constitutes a lack of variance depending on the number of items in the instrument
  
  # iterate over scales
  for (scale in names(study1_instruments[[instrument]])) {
    scale_items <- study1_instruments[[instrument]][[scale]]
    
    # Average rowwise if conditions are met using apply()
    study1_df[[scale]] <- apply(study1_df[scale_items], 1, calculate_scale_score, unique_column = unique_column, cutoff = cutoff)
  }
}

rm(study1_instruments, instrument, unique_column, instrument_items, cutoff, scale, scale_items, study1_df_recoded, variance_for_manyitems, variance_for_fewitems, threshold_fewormanyitems)

# rename multiple choice options to have meaningful names
study1_df <- study1_df %>%
  rename(base_intent_mailing = base_tpb13,
         base_intent_flyer = base_tpb14,
         base_intent_donation = base_tpb15,
         perfo_intent_mailing = perfo_tpb13,
         perfo_intent_flyer = perfo_tpb14,
         perfo_intent_donation = perfo_tpb15,
         docu_intent_mailing = docu_tpb13,
         docu_intent_flyer = docu_tpb14,
         docu_intent_donation = docu_tpb15,
         motivation_curious = motivation1,
         motivation_interested = motivation2,
         motivation_socialjustice = motivation3,
         motivation_helpresearch = motivation4,
         motivation_enjoy = motivation5,
         relationship_artist = relationship1,
         relationship_researcher = relationship2,
         relationship_none = `relationship-1`,
         identity_woman = identity1,
         identity_genderdiverse = identity2,
         identity_lgbq = identity3,
         identity_indigenous = identity4,
         identity_poc = identity5,
         identity_none = `identity-1`,
         identity_NA = `identity-9`,
         experience_disability = experience1,
         experience_charges = experience2,
         experience_unsheltered = experience3,
         experience_none = `experience-1`,
         experience_NA = `experience-9`)

# recode motivation variables
study1_df <- study1_df %>%
  mutate(across(
    .cols = starts_with("motivation_"),
    .fns = ~ ifelse(!is.na(.), 1, 0)
  ))

# set dummy variable indicating whether participant completed both halves of the event 
study1_df$completed <- !grepl("aborted", study1_df$notes, fixed = TRUE)

# factorize order and attendance (copied from Schlichting_MSc_Thesis.Rmd)
study1_df <- study1_df %>%
  mutate(order = factor(order, levels=c("film-perfo", "perfo-film"), labels=c("Film first", "Perf first")),
         attendance = factor(attendance, levels=c("in-person", "livestream"), labels=c("In-person", "Livestream")),
         base_behavioural_intention_z = my_z_score(base_behavioural_intention),
         cell = factor(interaction(order, attendance), levels = c("Film first.In-person", "Film first.Livestream", "Perf first.In-person", "Perf first.Livestream"), labels = c("F-P: In-person", "F-P: Livestream", "P-F: In-person", "P-F: Livestream"))) %>%
  rowwise() %>%
  # compute behaviour indices
  mutate(sum_behaviour = ifelse(completed == FALSE, NA, sum(mailing, flyer, post_donation)),
         sum_behaviour_fact = factor(sum_behaviour, levels = c("0", "1", "2", "3"), ordered = TRUE),
         sum_behaviour_inclNA = ifelse(completed == FALSE, NA, sum(mailing, flyer, post_donation, na.rm = TRUE)),
         sum_behaviour_inclNA_fact = factor(sum_behaviour_inclNA, levels = c("0", "1", "2", "3"), ordered = TRUE),
         behaviour_dich = ifelse(completed == FALSE, NA, 
                                 ifelse(sum_behaviour_inclNA %in% c(1:3), 1, 0))) %>%
  ungroup()


#### DF over 2 timepoints (intermission, end) for baseline-corrected analyses (copied from Schlichting_MSc_Thesis.Rmd) ###

docu_vars <- grep("^docu_", colnames(study1_df), value=TRUE)
perfo_vars <- grep("^perfo_", colnames(study1_df), value=TRUE)
docu_vars <- setdiff(docu_vars, "docu_understand_anna")
# perfo_vars <- setdiff(perfo_vars, grep("describe", perfo_vars, value=TRUE))

study1_2long <- study1_df %>%
  pivot_longer(all_of(c(docu_vars, perfo_vars)), names_to = c("medium", ".value"), names_pattern = "^(.*?)_(.*)$") %>%
  mutate(medium = factor(medium, levels=c("docu", "perfo"), labels=c("Film", "Performance")), # factorize medium
         timepoint = factor(interaction(day, medium), levels = c("0.Film", "1.Film", "0.Performance", "1.Performance"), labels = c("Intermission", "End", "End", "Intermission")), # determine timepoint
         ordermedium = factor(interaction(day, medium), levels = c("0.Film", "0.Performance", "1.Performance", "1.Film"), labels = c("F-P: Film", "F-P: Performance", "P-F: Performance", "P-F: Film")), # concatenate order and medium
         cell = factor(paste(attendance, order, medium, sep="."))) %>% # concatenate attendance, order, & medium
  mutate(across(.cols = all_of(c("demo_openness", "base_ios_anna", "base_anna_empathic_concern", "base_problem_awareness", "base_behavioural_intention", "base_anna_personal_distress", "ios_anna", "anna_empathic_concern", "problem_awareness", "behavioural_intention", "anna_personal_distress")), .fns = my_z_score, .names = "{.col}_z")) # z-score variables

# set contrasts
contrasts(study1_2long$order) <- cbind(FPvsPF = c(1, -1))
# attr(,"contrasts")
#           FPvsPF
# Film first      1
# Perf first     -1
# Levels: Film first Perf first

contrasts(study1_2long$medium) <- cbind(PerfvsFilm = c(-1, 1))
# attr(,"contrasts")
#             PerfvsFilm
# Film                -1
# Performance          1
# Levels: Film Performance

contrasts(study1_2long$timepoint) <- cbind(EndvsInter = c(-1, 1))
# attr(,"contrasts")
#              EndvsInter
# Intermission         -1
# End                   1
# Levels: Intermission End

contrasts(study1_2long$attendance) <- cbind(InpersonvsStream = c(1, -1))
# attr(,"contrasts")
#            InpersonvsStream
# In-person                 1
# Livestream               -1
# Levels: In-person Livestream

# dichotomize control variable
study1_2long <- study1_2long %>%
  mutate(
  motivation_socialjustice_dich = factor(motivation_socialjustice, levels = c(0, 1), labels = c("No", "Yes")))
contrasts(study1_2long$motivation_socialjustice_dich) <- cbind(YesvsNo = c(-1, 1))

# z-score control variables
study1_2long$trait_empathic_concern_z <- my_z_score(study1_2long$trait_empathic_concern)
study1_2long$politics_z <- my_z_score(study1_2long$politics)
study1_2long$trait_openness_z <- my_z_score(study1_2long$demo_openness)



#### DF over three timepoints (base, intermission, end) for plotting (copied from Schlichting_MSc_Thesis.Rmd) ###

# get names of variables that were tested across three timepoints
base_vars <- grep("^base_", colnames(study1_df), value=TRUE)
post_vars <- grep("^post_", colnames(study1_df), value=TRUE)

# gather to long format across base, docu, and perfo timepoints
study1_3long <- study1_df %>%
  pivot_longer(all_of(c(base_vars, docu_vars, perfo_vars, post_vars)), names_to = c("medium", ".value"), names_pattern = "^(.*?)_(.*)$") %>%
  # merge post measures with the medium that came last
  mutate(
    medium = case_when(
      medium == "post" & order == "Film first" ~ "perfo",
      medium == "post" & order == "Perf first" ~ "docu",
      TRUE ~ medium
    )
  ) %>%
  # pivot_long over post_vars introduced duplicate rows, so summarise those duplicates into one row by taking the first non-NA value for each variable
  group_by(p_id, medium) %>%
  summarise(across(everything(), ~ first(na.omit(.))), .groups = "drop") %>% 
  mutate(medium = factor(medium, levels=c("base", "docu", "perfo"), labels=c("Baseline", "Film", "Performance")),
         timepoint = factor(interaction(day, medium), levels = c("0.Baseline", "1.Baseline", "0.Film", "1.Film", "0.Performance", "1.Performance"), labels = c("Baseline", "Baseline", "Intermission", "End", "End", "Intermission"))) %>%
  arrange(p_id, match(timepoint, c("Baseline", "Intermission", "End"))) %>%
  # rename personal distress/empathic concern variables to specify target
  rename_with(.fn = ~ paste0("anna_", .), .cols = c(starts_with("pd"), starts_with("ec")))

rm(base_vars, docu_vars, perfo_vars, post_vars)
```

```{r}
#| label: prepstudy2
#| include: false

# TODO check whether participants guessed hypotheses and flag for analysis

# load study 2 data
study2_df_deident <- read_csv(here("data/study2_df_deident.csv"))

# define mapping of variables to scales to instruments
study2_instruments <- list(
  base_target_empathy = list(
    base_target_empathic_concern = c("base_target_ec1", "base_target_ec2", "base_target_ec3", "base_target_ec4", "base_target_ec5", "base_target_ec6"),
    base_target_personal_distress = c("base_target_pd1", "base_target_pd2", "base_target_pd3", "base_target_pd4", "base_target_pd5", "base_target_pd6", "base_target_pd7", "base_target_pd8")),
  base_ios = list(
    base_ios = c("base_ios_allen", "base_ios_john", "base_ios_anna", "base_ios_inperson", "base_ios_remote")),
  base_anna_empathy = list(
    base_anna_empathic_concern = c("base_anna_ec1", "base_anna_ec2", "base_anna_ec3", "base_anna_ec4", "base_anna_ec5", "base_anna_ec6"),
    base_anna_personal_distress = c("base_anna_pd1", "base_anna_pd2", "base_anna_pd3", "base_anna_pd4", "base_anna_pd5", "base_anna_pd6", "base_anna_pd7", "base_anna_pd8")),
  base_namtpb = list(
    base_problem_awareness = c("base_nam1", "base_nam2", "base_nam3", "base_nam4"),
    base_ascribed_responsibility = c("base_nam5", "base_nam6", "base_nam7", "base_nam8"),
    base_personal_norm = c("base_nam9", "base_nam10", "base_nam11", "base_nam12"),
    base_attitude = c("base_tpb1", "base_tpb2", "base_tpb3", "base_tpb4"),
    base_subjective_norm = c("base_tpb5", "base_tpb6", "base_tpb7", "base_tpb8"),
    base_behavioural_control = c("base_tpb9", "base_tpb10", "base_tpb11", "base_tpb12"),
    base_behavioural_intention = c("base_tpb13", "base_tpb14", "base_tpb15")),
  base_affect = list(
    base_affect = grep("base_emotion", colnames(study2_df_deident), value = TRUE)),
  post_affect = list(
    post_affect = grep("post_emotion", colnames(study2_df_deident), value = TRUE)),
  post_engagement = list(
    post_engagement = c("enjoy", "interest", "moved", "insight", "concentration", "chills", "tears", "reengage")),
  post_target_empathy = list(
    post_target_empathic_concern = c("post_target_ec1", "post_target_ec2", "post_target_ec3", "post_target_ec4", "post_target_ec5", "post_target_ec6"),
    post_target_personal_distress = c("post_target_pd1", "post_target_pd2", "post_target_pd3", "post_target_pd4", "post_target_pd5", "post_target_pd6", "post_target_pd7", "post_target_pd8")),
  post_ios = list(
    post_ios = c("post_ios_allen", "post_ios_john", "post_ios_anna", "post_ios_inperson", "post_ios_remote")),
  post_anna_empathy = list(
    post_anna_empathic_concern = c("post_anna_ec1", "post_anna_ec2", "post_anna_ec3", "post_anna_ec4", "post_anna_ec5", "post_anna_ec6"),
    post_anna_personal_distress = c("post_anna_pd1", "post_anna_pd2", "post_anna_pd3", "post_anna_pd4", "post_anna_pd5", "post_anna_pd6", "post_anna_pd7", "post_anna_pd8")),
  post_namtpb = list(
    post_problem_awareness = c("post_nam1", "post_nam2", "post_nam3", "post_nam4"),
    post_ascribed_responsibility = c("post_nam5", "post_nam6", "post_nam7", "post_nam8"),
    post_personal_norm = c("post_nam9", "post_nam10", "post_nam11", "post_nam12"),
    post_attitude = c("post_tpb1", "post_tpb2", "post_tpb3", "post_tpb4"),
    post_subjective_norm = c("post_tpb5", "post_tpb6", "post_tpb7", "post_tpb8"),
    post_behavioural_control = c("post_tpb9", "post_tpb10", "post_tpb11", "post_tpb12"),
    post_behavioural_intention = c("post_tpb13", "post_tpb14", "post_tpb15")),
  demo_openness = list(
    demo_openness = grep("open", colnames(study2_df_deident), value = TRUE))
)


#### CHECK FOR SUFFICIENT VARIANCE ACROSS ITEMS OF ONE INSTRUMENT ###
variance_for_manyitems <- 2
variance_for_fewitems <- 1
threshold_fewormanyitems <- 10

study2_df_variance <- study2_df_deident %>% # make copy of dataframe
  rename_with(
    .fn = ~ str_replace(., "^post_", ""), # rename engagement variables for consistency with study1
    .cols = c("post_enjoy", "post_interest", "post_moved", "post_insight", "post_concentration", "post_chills", "post_tears", "post_reengage")
  )

study2_total_instrument_observations <- 0 # counter for total instruments checked across participants
study2_novariance_observations <- 0 # counter for instruments with lack of variance

# iterate over instruments
for (instrument in names(study2_instruments)) {
  # get all item columns of the instrument
  items <- c()
  for (scale in names(study2_instruments[[instrument]])) {
    items <- c(items, study2_instruments[[instrument]][[scale]])
  }
  
  # count unique values and store in new column
  unique_column <- paste0(instrument, "_unique") # name of the new column that stores the number of unique values
  study2_df_variance <- study2_df_variance %>%
    rowwise() %>%
    mutate(!!unique_column := n_distinct(c_across(all_of(items)), na.rm = TRUE)) %>%
    ungroup()
  
  # count number of observations that lack variances
  cutoff <- ifelse(length(items) > threshold_fewormanyitems, variance_for_manyitems, variance_for_fewitems) # define what constitutes a lack of variance depending on the number of items in the instrument
  
  total <- sum(study2_df_variance[[unique_column]] > 0 & !is.na(study2_df_variance[[unique_column]])) # count total observations per instrument
  novariance <- sum(study2_df_variance[[unique_column]] > 0 & study2_df_variance[[unique_column]] <= cutoff, na.rm = TRUE) # count cases where unique values are below cutoff
  
  study2_total_instrument_observations = study2_total_instrument_observations + total # update counters
  study2_novariance_observations = study2_novariance_observations + novariance
}

rm(instrument, items, scale, unique_column, cutoff, total, novariance, study2_df_deident)



#### RECODE REVERSE-CODED ITEMS ###

study2_df_recoded <- study2_df_variance %>%
  rowwise() %>%
  mutate(mailing_presubsribed = ifelse(mailing == -9, 1, 0),
         across(.cols = c(age, caffeine, liking, income, education, politics, mailing),
                .fns = ~ case_match(.x, -9 ~ NA, .default = .x)),
         resource_click = case_match(resource_noclick, 0 ~ FALSE, .default = resource_click),
         donation_click = case_match(donation_noclick, 0 ~ FALSE, .default = donation_click),
         across(.cols = c(base_nam3, base_tpb11, post_nam3, post_tpb11),
                .fns = ~ 8 - .x),
         across(.cols = c(open1, open6, open11),
                .fns = ~ 6 - .x)) %>%
  ungroup() %>%
  select(-c(resource_noclick, donation_noclick))

rm(study2_df_variance)



#### cALCULATE CONSTRUCT SCORES IF AT LEAST 80% OF ITEMS HAVE BEEN ANSWERED AND IF THERE IS SUFFICIENT VARIANCE ###

study2_df <- study2_df_recoded %>%
  rowwise() %>%
  mutate(
    # calculate affect scales
    base_pleasure = base_emotion3 - base_emotion6,
    base_awake = base_emotion5 - base_emotion1,
    base_tense = base_emotion2 - base_emotion4,
    post_pleasure = post_emotion3 - post_emotion6,
    post_awake = post_emotion5 - post_emotion1,
    post_tense = post_emotion2 - post_emotion4
  ) %>%
  ungroup()

# iterate over instruments
for (instrument in names(study2_instruments)) {
  if (instrument %in% c("base_ios", "base_affect", "post_affect", "post_engagement", "post_ios")) next # skip instruments that should not be averaged
  
  unique_column <- paste0(instrument, "_unique") # name of the column that stores the number of unique values
  
  # get all item columns of the instrument
  instrument_items <- c()
  for (scale in names(study2_instruments[[instrument]])) {
    instrument_items <- c(instrument_items, study2_instruments[[instrument]][[scale]])
  }
  
  cutoff <- ifelse(length(instrument_items) > threshold_fewormanyitems, variance_for_manyitems, variance_for_fewitems) # define what constitutes a lack of variance depending on the number of items in the instrument
  
  # iterate over scales
  for (scale in names(study2_instruments[[instrument]])) {
    scale_items <- study2_instruments[[instrument]][[scale]]
    
    # Average rowwise if conditions are met using apply()
    study2_df[[scale]] <- apply(study2_df[scale_items], 1, calculate_scale_score, unique_column = unique_column, cutoff = cutoff)
  }
}

rm(instrument, study2_instruments, unique_column, instrument_items, cutoff, scale, scale_items, study2_df_recoded, variance_for_manyitems, variance_for_fewitems, threshold_fewormanyitems)

# rename items to have meaningful names
study2_df <- study2_df %>%
  rename(base_intent_mailing = base_tpb13,
         base_intent_flyer = base_tpb14,
         base_intent_donation = base_tpb15,
         post_intent_mailing = post_tpb13,
         post_intent_flyer = post_tpb14,
         post_intent_donation = post_tpb15,
         identity_woman = identity4,
         identity_genderdiverse = identity5, 
         identity_lgbq = identity3,
         identity_indigenous = identity1,
         identity_poc = identity2,
         identity_religious = identity6,
         identity_none = `identity-1`,
         identity_NA = `identity-9`,
         experience_disability = experience1,
         experience_charges = experience2,
         experience_unsheltered = experience3,
         experience_none = `experience-1`,
         experience_NA = `experience-9`,
         flyer = resource_click) %>%
  # add metadata to match study 1
  mutate(order = case_match(group,
                            "group_film" ~ "Film first",
                            "group_perf" ~ "Perf first",
                            .default = group),
         attendance = "Livestream",
         p_nr = as.character(c(1:nrow(study2_df))),
         p_id = paste0("sub-on2", p_nr)
  )

# factorize order and attendance (copied from Schlichting_MSc_Thesis.Rmd)
study2_df <- study2_df %>%
  mutate(base_behavioural_intention_z = my_z_score(base_behavioural_intention)) %>%
  rowwise() %>%
  # compute behaviour indices
  mutate(sum_behaviour = sum(mailing, flyer, post_donation),
         sum_behaviour_fact = factor(sum_behaviour, levels = c("0", "1", "2", "3"), ordered = TRUE),
         sum_behaviour_inclNA = sum(mailing, flyer, post_donation, na.rm = TRUE),
         sum_behaviour_inclNA_fact = factor(sum_behaviour_inclNA, levels = c("0", "1", "2", "3"), ordered = TRUE),
         behaviour_dich = ifelse(sum_behaviour_inclNA %in% c(1:3), 1, 0)) %>%
  ungroup()


#### DF over two timepoints (base, end) for plotting & analysis ###

# get names of variables that were tested across two timepoints
base_vars <- grep("^base_", colnames(study2_df), value=TRUE)
post_vars <- grep("^post_", colnames(study2_df), value=TRUE)

# remove non-overlapping variables
# post_vars <- setdiff(post_vars, grep("^post_describe", post_vars, value = TRUE))
# post_vars <- setdiff(post_vars, grep("^post_immersion", post_vars, value = TRUE))
# post_vars <- setdiff(post_vars, c("post_concentration", "post_moved", "post_tears", "post_enjoy", "post_interest", "post_chills", "post_reengage", "post_insight", "post_duration", "post_engagement_unique"))

# gather to long format across base, docu, and perfo timepoints
study2_long <- study2_df %>%
  pivot_longer(all_of(c(base_vars, post_vars)), names_to = c("timepoint", ".value"), names_pattern = "^(.*?)_(.*)$") %>%
  mutate(timepoint = factor(timepoint, levels = c("base", "post"), labels = c("Baseline", "End")),
         medium = case_when(
           timepoint == "Baseline" ~ "Baseline",
           timepoint == "End" & order == "Film first" ~ "Film",
           timepoint == "End" & order == "Perf first" ~ "Performance",
           TRUE ~ NA
         )) %>%
  mutate(across(.cols = all_of(c("ios_anna", "anna_empathic_concern", "problem_awareness", "behavioural_intention", "anna_personal_distress", "ios_target", "target_empathic_concern")), .fns = my_z_score, .names = "{.col}_z")) # z-score variables

# set contrasts
contrasts(study2_long$timepoint) <- cbind(PostvsPre = c(-1, 1))
contrasts(study2_long$group) <- cbind(PerfvsFilm = c(-1, 1))

rm(base_vars, post_vars)
```

```{r}
#| label: combinestudies
#| include: false

# Combine study 1 & 2 for plotting
combined_long <- study1_3long %>%
  bind_rows(study2_long, .id = "study") %>%
  mutate(study = factor(study, labels = c("Study 1", "Study 2")),
        facet = factor(paste(study, attendance), levels = c("Study 1 In-person", "Study 1 Livestream", "Study 2 Livestream"), labels = c("Study 1 In-person", "Study 1 Livestream", "Study 2 Stream")),
        order = factor(order, levels = c("Film first", "Perf first"), labels = c("Film-Perf", "Perf-Film")),
        # dodge order for meanSE plots
        dodge_order = case_when(
          timepoint == "Baseline" ~ as.numeric(order) - .3,
          timepoint == "Intermission" ~ as.numeric(order),
          (study == "Study 1" & timepoint == "End") ~ as.numeric(order) + .3,
          (study == "Study 2" & timepoint == "End") ~ as.numeric(order)
        ),
        # x-axis ticks for meanSE plots
        xticks = case_when(
          study == "Study 1" ~ order,
          (study == "Study 2" & order == "Film-Perf") ~ "Film",
          (study == "Study 2" & order == "Perf-Film" ~ "Perf")
        ),
        # encode which medium comes next for the color of the summary lines
        nextmedium = case_when(
          timepoint == "End" ~ "End",
          (order == "Film-Perf" & timepoint == "Baseline") ~ "Film",
          (order == "Film-Perf" & timepoint == "Intermission") ~ "Performance",
          (order == "Perf-Film" & timepoint == "Baseline") ~ "Performance",
          (order == "Perf-Film" & timepoint == "Intermission") ~ "Film"
        ),
        jitter_ios_anna = jitter(ios_anna, amount = .15), 
        jitter_ios_target = jitter(ios_target, amount = .15),
        jitter_anna_empathy = jitter(anna_empathic_concern, amount = .15),
        jitter_target_empathy = jitter(target_empathic_concern, amount = .15),
        jitter_awareness = jitter(problem_awareness, amount = .15)) 
```

Despite our shared struggle for a better world, societies remain unjust. For example, criminal justice systems were implemented to enforce justice, but across societies, systemic issues lead to the wrongful imprisonment of innocent individuals. How do we mobilize support to fight social injustice such as wrongful imprisonment? Arts and media are a way of reaching and engaging broad audiences. Film, TV, and theatre, using the power of storytelling, can shape attitudes and behaviours with regards to social injustice. Music is also commonly used to advocate for social justice issues, for instance in the forms of charity concerts and protest songs. Given that music typically has less narration than the previously studied media, it remains unclear how socially responsible music promotes audiences' engagement with social justice issues. While previous research has uncovered how music shapes our evaluation of the people making the music or listening to it, few studies have investigated how music influences our views of people and issues that are the subject of music. In addition, theories of prosocial behaviour and social engagement put forward various predictors that could explain how arts and media can advocate for social justice issues. This plurality makes it difficult for researchers to integrate previous works, and for artists to understand which factors are decisive to effectively engage their audience.

In two studies, we evaluate how an abstract music performance engages audiences with the issue of wrongful imprisonment, compared to a narrative documentary film. We assess changes in three affective and cognitive variables, empathic concern, relationship closeness, and problem awareness, and compare their influence on supportive behaviour of audiences in the concert hall and at home. This study provides empirical support for the mobilizing potential of music as a medium with less narration, and highlights which facet of audiences' attitudes artists should appeal to in order to gain support for their cause.

## Mobilizing support for social justice causes

The aim of social justice advocacy is to foster engagement with a social justice issue and mobilize supportive behaviour for that cause. Various psychological theories have identified factors which promote behaviour that benefits others, and which could be applicable in the context of social justice advocacy. This plurality hinders theory integration across studies of socially responsible behaviour. It is therefore necessary to empirically compare the relevance of different factors [@bekkers2011]. In this study, we compare normative, empathic, and relational factors.

Justice is a moral concept, and fighting injustices or supporting social justice causes can be conceived as morally-driven behaviour. The norm activation model [NAM, @schwartz1977] lays out the process of how personal norms create a moral obligation to act. According to the model, an actor first has to become aware of a problematic situation, e.g., wrongful imprisonment, that creates a need for those affected by the problem, e.g., innocent prisoners. Subsequently, an actor needs to feel responsible for changing the problematic situation and responding to the need of those affected, e.g., by making a donation to an NGO that re-investigates cases of wrongful imprisonment. As a third component, the problem must be relevant to the personal norms of the actor, e.g., justice in the legal system, for these norms to be activated and to guide the actor's behaviour in that situation. In combination, problem awareness, ascription of responsibility, and personal norms create a moral obligation to help solve the problem or reduce the need of those affected, so that the actor acts in accordance with their norms [@schwartz1977; @degroot2009]. Importantly, the NAM postulates a causal chain of the three components, which explains why people do not always adhere to all of their norms: If one is not aware of a problem or does not believe that they can change it, their norms are not activated in that situation and therefore can not guide their behaviour [although the empirical evidence regarding this causal chain is mixed, @klockner2013].

Studies on prosocial and pro-environmental behaviour [e.g., @degroot2009; @savari2023; @steg2010] commonly integrate the NAM with the theory of planned behaviour [TPB, @ajzen1991; @ajzen2011]. While there is some conceptual overlap between responsibility in the NAM and efficacy in the TPB, as well as between norms in the NAM and attitudes in the TPB, the TPB crucially contributes the behavioural intention as the most proximal predictor of behaviour. The idea is that rational (or planned) behaviour is always preceded by a decision to engage in that behaviour. Therefore, all other predictors of behaviour influence this decision, which in turn mediates the actual behaviour [@ajzen1991; @ajzen2011]. Separating intention and behaviour reduces noise in the analysis, because the translation of intention into behaviour can be hindered by external factors beyond the scope of studying what motivates actors to engage in a behaviour [e.g., lack of resources, or unexpected situations, @sheeran2002]. In conclusion, social justice advocacy can mobilize supportive behaviour by raising awareness for a problem, appealing to the audience's responsibility, or strengthening norms regarding social justice, which contribute to the intention to support the social justice cause. However, problem awareness might have to precede the other components, especially when the social justice issue is lesser known.

Beyond the moral motive, altruistic motives can promote the support of social justice causes. According to the empathy-altruism hypothesis, empathically adopting the perspective of a person in need creates an altruistic motivation to reduce their suffering. For example, empathizing with the experience of an innocent prisoner may give rise to a sense of concern about their well-being, which translates into a motivation to help to improve the well-being of the innocent prisoner, regardless of the behavioural consequences for oneself [@batson1987; @batson2011]. There has been a long debate on whether helping can be purely altruistic, in that the actor is only acting in the interest of the person receiving the help, or whether the actor always has an egoistic interest to reduce their own distress arising from witnessing the other person suffering [e.g., @cialdini1997; for a review, see @batson2011]. Both empathic concern and personal distress, however, arise from empathic perspective-taking. <!-- TODO add that empathizing is effortful, therefore motivate audiences to empathize (rather than improve their ability to empathize; Weisz & Zaki, 2017). --> Hence, social justice advocacy can mobilize supportive behaviour by conveying the experiences and point of view of those affected by the social justice issue, thereby facilitating empathic responses from the audience.

Finally, social relationships play an important role in supporting social justice causes. A body of literature reports that perceived similarity and familiarity with another person strengthen the tendency to help them [@burger2004; @batson1981; @batson1995; @sole1975]. One possible explanation is that if one feels closer to a person in need, it is easier to empathize with their need, and one cares more for their well-being, thus facilitating the empathically motivated altruism described above [@batson1981; @batson1995; @sturmer2009]. In another line of argumentation, if one feels closer to a person in need, one values their social approval more and therefore might help them in hopes of getting their approval, or avoiding the risk of social punishment for not helping them [@bekkers2011]. Similarly, a close relationship with those who observe the act of helping may also create a social pressure to help, given that the observers approve of the helping [@bekkers2011]. Therefore, social justice advocacy can mobilize supportive behaviour by tightening the social bonds between audiences and those affected by the social justice issue, which should increase the tendency to help.

## Advocacy through art

Social injustices often become the subject of art. Beyond a mere inspiration or description of society, art is used to criticize social injustices and advocate for social justice. Empirical evaluations of such advocacy through art have proven effects of media like documentary films, theatre, and songs on the aforementioned normative, empathic, and relational dimensions, and on behaviour in support of social justice causes. For example, @reddan2024 compared audience responses to a documentary about wrongful imprisonment and two documentaries about injustices in sports, and found that the former enhanced audiences' empathic responses towards prisoners, attitudes towards prison reform, and intentions to support a petition to restore voting rights for people with felony convictions. Documentaries about personal life stories also increase social bonding with other audience members [@dunbar2016]. These studies are comparable to the somewhat larger body of literature attesting that documentaries about climate change increase audiences' concern and pro-environmental intentions [@howell2011; @nolan2010; @sakellari2015]. Turning to theatre, audiences of theatre performances about disadvantaged groups have been shown to be more empathetic with the represented groups and more willing to donate to charity after the performance, compared to before. Effects on theatre audiences' attitudes remained ambiguous [@rathje2021]. Moreover, songs with prosocial lyrics like "Love Generation" by Bob Sinclair have been shown to prompt prosocial thoughts and empathic responses in listeners, with empathy mediating the effect of the lyrical content on charitable donations [@greitemeyer2009; @greitemeyer2009a].

<!-- TODO Theatre: see alse Troxler et al., 2022 & Greene et al., 2018 -->

Most of the research cited above theorizes that art, be it film, theatre, or song, achieves its advocacy effect through powerful narratives influencing audiences' emotions and cognition regarding the advocacy topic. However, not all art makes use of explicit narration. Visual art, for example, often conveys social critique in an implicit, symbolic, or abstract manner [e.g., @pelowski2024]. Similarly, much music beyond the song form is carried more by sounds and less by lyrics, and therefore has less tools for explicit narration. Still, there are many examples of classical and jazz music intended to advocate for concrete issues: The West-Eastern Divan Orchestra, a classical symphony orchestra with Israeli and Palestinian musicians, promotes a peaceful solution to the Arab-Israeli conflict by playing for concert audiences and politicians alike (<https://west-eastern-divan.org/>). Jazz icons sonified the struggle for racial justice with works such as Duke Ellington's *Black and Tan Fantasy*, Oscar Peterson's *Hymn to Freedom*, and John Coltrane's *Alabama* (<https://naacpsfnm.org/jazz-and-civil-rights/>). And *The Innocents,* a percussion performance about wrongful imprisonment in the United States, tours schools and universities to educate and engage its audience with this often overlooked social injustice (<https://www.the-innocents.com/>). How does such music mobilize support for social justice causes, if not through explicit narrative lyrics?

Music excels at arousing emotions in the listener. Thinking back to the theoretical frameworks of social justice advocacy, it could therefore be expected that music advocates by eliciting empathic responses and strengthening social bonds among listeners, whereas narrative media like documentary films might be more effective in raising problem awareness. Indeed, making music together can promote empathy [@clarke2015; @rabinowitch2013; @tzanaki2025], though it remains unclear to which extent listening to music advocacy, rather than making music, can promote empathy. Moreover, both making and listening to music can strengthen social bonds with other musicians and listeners [@savage2021; @mogan2017; @swarbrick2023]. However, there is an ongoing debate as to who those social bonds extend to, beyond the musicians and listeners who are part of the music experience [@rabinowitch2023; @cirelli2016; @reddish2014; @reddish2016; @cross2020; @cross2019]. This latter aspect is crucial for advocacy contexts, because the recipients of charitable behaviour are usually absent during the advocacy [e.g., when an activist speaks to a potential donor at a fundraiser for prison reforms, the affected prisoners usually are not present, @bekkers2011]. In conclusion, if music advocacy can raise awareness about social injustice, promote empathy with victims of injustice, or strengthen social bonds with them, any of these effects could explain why audiences would support the advocacy cause.

## Collective aspects of audience experience

Historically, audiences of both music and film would typically gather together in a concert venue or cinema to collectively experience a performance or screening. Over the past decades, however, inventions in disc storage devices, and more recently in streaming services, have led to a shift towards individual experiences of music and film in private audiovisual environments at home or via personal screens and headphones. Media and communications research has theorized that being part of an audience gives rise to a different experience than watching or listening alone: In their reciprocal feedback model of musical communication, @hargreaves2005 emphasize that the presence or absence of others influences both the listener's response to music, as well as the performance of the music itself. In contrast to recorded or broadcast performances, live music performances allows for bidirectional communication between spatio-temporally co-present performers and audience members: The performer can communicate through more channels than just the sound itself, and the audience can shape the performance through their immediate reactions. @wald-fuhrmann2021 corroborate the importance of the presence of musicians and audience members in shaping audiences' aesthetic experience of music. In addition to the communication between musicians and audience members, they also consider the roles of the communication among audience members during, as well as before and after a music performance, and of the synchronization of bodily responses (like moving and cardiorespiratory activity) of co-present audience members. These factors might explain why music that is experienced together with other audience members has been found to elicit more intense emotional reactions [@liljestrom2013; though see @egermann2011], immersion/absorption [@kreuzer2025; @swarbrick2024], and intellectual stimulation [@kreuzer2025], than experiencing the same music alone or as part of a virtual audience.

TODO elaborate theoretical predictions [@hanich2017; @hanich2014] and empirical film research [@kaltwasser2019]

To our knowledge, very little is known about how the presence or absence of other audience members affects the mobilization potential of advocacy through art.

-   [@swarbrick2023; @onderdijk2021]: audience/musician co-presence influences connectedness, which plays a role in advocacy

-   social pressure of other audience members could enhance effects

in-person event: social contagion/collective action with performers (music only) or audience members (film and music) could enhance effects. And adds ecological validity

no study has compared advocacy effects on individual vs. collective audience

## The present studies

In two studies, we compared how the abstract percussion performance *The Innocents*, and the narrative documentary film of the same title, mobilize support for the fight against wrongful imprisonment. Integrating multiple theoretical frameworks of social justice interventions, we assessed the effects of performance and film on problem awareness, empathic concern, and social bonding, and evaluated the contribution of these three variables to supportive behaviour. In Study 1, audiences in the concert hall and at home experienced an event featuring both a live performance of *The Innocents* and a screening of the documentary. Participants answered surveys before and after each presentation and we observed their charitable behaviour at the end of the event, as an initial test of the hypotheses. In Study 2, participants at home watched either the performance or the film, to replicate the findings of Study 1 in a larger sample and clarify ambiguities in the comparison between the two stimuli.

# Study 1

Study 1 aimed to maximize ecological validity by evaluating two public events, organized on April 2nd and 4th, 2024. Both events featured percussionists John Lane and Allen Otte performing *The Innocents,* and a screening of the eponymous documentary film by Wojciech Lorenc, in counterbalanced order. The events could be attended either in-person or in an online livestream. Participation in the research study was optional for audience members, thus the events were attended by research participants and regular ticket holders alike. We tested the following hypotheses:

1.  Documentary films have been shown to influence audiences' cognitions about a topic by means of their explicit narrative, whereas abstract music has a more ambiguous meaning. Therefore, we expected the film to increase audiences' awareness of wrongful imprisonment more than the performance (1a). Based on the norm activation model, we expected problem awareness to predict charitable intentions (1b).
2.  Based on previous findings of empathic responses to watching films and making music, we expected both the film and the performance to increase audiences' empathic concern for wrongfully imprisoned individuals. We further expected that the performance would show larger increases for in-person compared to livestream audiences (2a). We made no prediction whether the film or the performance would have a stronger effect on empathy; rather, we were interested in showing whether the performance would have an effect on empathy at all, and to use the film as a comparison to interpret the size of a potential effect. Based on the empathy-altruism hypothesis, we expected empathic concern to predict charitable intentions (2b).
3.  Both watching films and listening to music together has been shown to strengthen social bonds among audience members, although it is unclear to which extent these bonds extend to the subjects of the film or music. Against this backdrop, we expected that the film and the performance would increase audiences' closeness with wrongfully imprisoned individuals. Again, we expected the effect of the performance to be larger for in-person compared to online audiences (3a). Based on associations between social relationships and helping, we expected closeness to predict charitable intentions (3b).
4.  Based on the theory of planned behaviour, we expected charitable intentions to predict behaviour in support of a charity that fights wrongful imprisonment.

## Method

### Participants

```{r}
#| label: sample-size
#| include: false

sample_size <- study1_df %>%
  group_by(day, attendance, completed) %>%
  summarise(N = n())
```

Leading up to the event, all ticket holders were invited to sign up for participation in the research study via email. In addition, we asked in-person ticket holders as they arrived at the venue whether they would like to participate, and recruited additional livestream participants through Prolific. Participants had to be 16 years or older, have healthy hearing and vision, and have not seen the performance or the film before. We initially restricted the upper age limit to 60 years to avoid age effects on eye movements, which were collected for a different research question and not analysed here. However, we made an exception for one participant over 60 who expressed interest in participating. By buying a ticket for in-person or livestream attendance at one of the events, participants self-assigned to an attendance mode and an order of stimli. However, participants were blind to the order in which film and performance would be presented on each of the days, since we did not advertise this information. A total of `r printnum(sum(subset(sample_size, completed == 1)$N))` participants completed the study (day 1 in-person: `r printnum(subset(sample_size, day == 0 & attendance == "In-person" & completed == 1)$N)`; livestream: `r printnum(subset(sample_size, day == 0 & attendance == "Livestream" & completed == 1)$N)`; day 2 in-person: `r printnum(subset(sample_size, day == 1 & attendance == "In-person" & completed == 1)$N)`; livestream: `r printnum(subset(sample_size, day == 1 & attendance == "Livestream" & completed == 1)$N)`). In addition, one in-person participant and `r printnum(subset(sample_size, day == 0 & attendance == "Livestream" & completed == 0)$N)` livestream participants left the event at intermission on day 1, and one livestream participant left at intermission on day 2. They are included in all analyses for which their data are available. Livestream participants were watching from Africa, Europe, North America, Asia, and New Zealand, with most participants watching from South Africa ($n = `r printnum(length(which(study1_df$country == "South Africa")))`$). Upon completion of the study, ticket holders received \$10 CAD compensation and Prolific participants were compensated £18 GBP. For a detailed description of the sample, see @apx-sampledescription.

<!-- TODO describe pertinent sample characteristics; refer to detailed table in supplementary -->

### Procedure

Study 1 consisted of three surveys: A pre-survey before the event, a survey at intermission evaluating the stimulus presented in the first half of the event, and a survey at the end, evaluating the second half of the event. In addition, person-level covariates were assessed either in the pre-survey or in the survey at the end. After obtaining informed consent, the pre-survey assessed a baseline of the behavioural predictors interpersonal closeness with a wrongfully imprisoned person, state empathy for their story, problem awareness of wrongful imprisonment, and intentions to support organizations fighting wrongful imprisonment. Moreover, the pre-survey included the other NAM-TPB variables and an affect measure. Participants filled out the pre-survey either in the days leading up to the event, or in the hour right before the event. Closeness with the other audience members and affect were always assessed immediately before the event, because they are specific to the time and context of the event. Participants then saw the film or the performance in the first half of the event, and, after a 30-minute intermission, the other stimulus. After both the film and the performance, we assessed participants' affect, experience of the event, and again measured their closeness, empathy, awareness, and intentions. The end survey additionally included the remaining NAM-TPB variables, and some questions that were used to answer other research questions not analysed here. At the end of the event, we observed actual behaviour in support of *Innocence Canada*, an organization that advocates for innocent prisoners in Canada. Study 1 was approved by the McMaster Research Ethics Board (MREB#1975).

The events took place in McMaster University's Large Interactive Virtual Environment laboratory (LIVELab, <https://livelab.mcmaster.ca/>), a concert venue equipped for psychological research, and were livestreamed via YouTube. Livestream participants opened a custom website on their personal computers which presented the surveys and the event stream. To create a controlled experience, the website prohibited access to stream controls (like pausing the stream) and only displayed the video stream, not any additional YouTube features like the chat. Livestream participants were instructed to sit in a quiet environment and use headphones for the best experience, but `r printnum(nrow(subset(study1_df, speaker == 3)))` participants self-reported that they still used the built-in speakers of their machine. Nonetheless, the sound quality was rated as very good ($M = `r printnum(mean(study1_df$sound_quality, na.rm = TRUE), digits = 2)`$ on a 7-point scale), as was the video quality ($M =`r printnum(mean(study1_df$video_quality, na.rm = TRUE), digits = 2)`$), the video fluency ($M = `r printnum(mean(study1_df$video_fluency, na.rm = TRUE), digits = 2)`$), and the camera framing ($M =`r printnum(mean(study1_df$camera_frame, na.rm = TRUE), digits = 2)`$). In-person participants filled out the surveys on LIVELab's tablets or on paper. Participants who signed up in advance were given a link to fill out the pre-survey on their own machines. All surveys, and the presentation of the stream for livestream participants, were coded in jsPsych [@leeuw2023] and hosted through JATOS [@lange2015] on our lab server. Print versions and codebooks of the survey are available at <https://doi.org/10.5281/zenodo.15282949>. Note that in-person participants were equipped with mobile eye-tracking glasses and smartwatches for physiological measurements that were analysed for other research questions. For the same reason, livestream participants were recorded via their webcam. Both in-person and livestream participants had to undergo brief calibrations before and after the event and at intermission. For the full technical details of the event, see @apx-implementation.

### Stimuli

*The Innocents* [@lane2006] is a 1-hour contemporary percussion performance by musicians John Lane and Allen Otte. The performance explores issues of the US-American criminal justice system, such as mistaken identity, interrogation malpractices, and forced prison labor. Associated objects, like keys and newspapers, are utilized to create a diverse soundscape ranging from conventional song to experimental noise. In some parts, the musicians speak or sing text fragments, while other parts feature field recordings of demonstrations, interrogations, or police radio. With the performance, the musicians intend to motivate their audiences to engage with the topic of wrongful imprisonment, which they aim to achieve by means of an emotional and experiential immersion, all while remaining artistically abstract [@lane2021]. A full recording of the performance from April 4th, 2024 is available on YouTube (<https://www.youtube.com/watch?v=sQW0a3NlQUo&ab_channel=BEATLab>).

Director Wojciech Lorenc created an eponymous documentary film about *The Innocents* [@lorenc2022]. Over 80 minutes, the film features conversations between the musicians Lane and Otte about their creative process and personal rapport with the issue of wrongful imprisonment, and recordings of their rehearsals and interactions with audiences on tour. A third protagonist of the film is Anna Vasquez, who shares her personal story of being convicted for a crime she did not commit, and her thoughts and feelings about the *Innocents* performance. The film's score includes excerpts from the performance. Compared to the performance, the film has a more explicit narrative and educates through first-person accounts and realistic, unambiguous images. A trailer for the film is available on YouTube (<https://www.youtube.com/watch?v=PyYSohg-FpI&ab_channel=WojciechLorenc>).

### Measures

```{r}
#| label: study1-cronbach
#| include: false

# remove variables from previous block
rm(sample_size)

# Calculate cronbach's alpha for all scales
alpha_ec <- cronbach.alpha(study1_3long[, c("anna_ec1", "anna_ec2", "anna_ec3", "anna_ec4", "anna_ec5", "anna_ec6")], na.rm = TRUE)
alpha_pd <- cronbach.alpha(study1_3long[, c("anna_pd1", "anna_pd2", "anna_pd3", "anna_pd4", "anna_pd5", "anna_pd6", "anna_pd7", "anna_pd8")], na.rm = TRUE)
alpha_pa <- cronbach.alpha(study1_3long[, c("nam1", "nam2", "nam3", "nam4")], na.rm = TRUE)
alpha_ar <- cronbach.alpha(study1_3long[, c("nam5", "nam6", "nam7", "nam8")], na.rm = TRUE)
alpha_pn <- cronbach.alpha(study1_3long[, c("nam9", "nam10", "nam11", "nam12")], na.rm = TRUE)
alpha_at <- cronbach.alpha(study1_3long[, c("tpb1", "tpb2", "tpb3", "tpb4")], na.rm = TRUE)
alpha_sn <- cronbach.alpha(study1_3long[, c("tpb5", "tpb6", "tpb7", "tpb8")], na.rm = TRUE)
alpha_pbc <- cronbach.alpha(study1_3long[, c("tpb9", "tpb10", "tpb11", "tpb12")], na.rm = TRUE)
alpha_intention <- cronbach.alpha(study1_3long[, c("intent_mailing", "intent_flyer", "intent_donation")], na.rm = TRUE)
```

#### Interpersonal closeness

We measured interpersonal closeness with the Inclusion of the Other in the Self scale [@aron1992], a 7-point scale with pictorial anchors that show increasingly overlapping Venn diagrams with two circles labelled "self" and "other". Participants were instructed to rate which of the paired circles best described their relationship with the "other". Closeness was assessed separately for the musicians Allen Otte and John Lane, the wrongfully imprisoned Anna Vasquez, the in-person and the livestream audience.

#### State empathy

To measure state empathy, participants read a vignette about the story of Anna Vasquez's wrongful imprisonment and exoneration. We then administered the Empathic Concern Index [@batson1987] for which participants rate the intensity of 14 emotional reactions on a 7-point scale ranging from 1 ("not at all") to 7 ("extremely"). The items are averaged to obtain two indices, empathic concern ($\alpha = `r printnum(alpha_ec$alpha)`$) and personal distress ($\alpha =`r printnum(alpha_pd$alpha)`$).

#### Problem awareness

We created an instrument to measure the variables of the NAM and TPB with regards to fighting wrongful imprisonment. The item wordings were based on previous studies using the NAM and TPB to explain social justice engagement [@torres-harding2012], charitable giving [@smith2007], and pro-environmental behaviour [@degroot2009; @savari2023; @steg2010]. The instrument consists of four items for each of the NAM variables problem awareness (e.g., "Wrongful incarcerations are an urgent problem in our society"; $\alpha = `r printnum(alpha_pa$alpha)`$), ascription of responsibility (e.g., "Everyone must do something against social injustices in the legal system"; $\alpha =`r printnum(alpha_ar$alpha)`$), and personal norm (e.g., "I would feel guilty if I didn’t do something to make the criminal justice system more fair"; $\alpha = `r printnum(alpha_pn$alpha)`$), and the TPB variables attitude (e.g., "I believe that it is essential to make sure that defendants and convicts receive adequate legal support"; $\alpha =`r printnum(alpha_at$alpha)`$), subjective norm (e.g., "Other people around me support organizations and groups that fight injustices in the legal system"; $\alpha = `r printnum(alpha_sn$alpha)`$), and perceived behavioural control (e.g., "I believe that I have the power to advocate for social justice in the legal system, if I choose to do so"; $\alpha =`r printnum(alpha_pbc$alpha)`$). Behavioural intentions to support the fight against wrongful imprisonment was measured with three items relating to *Innocence Canada*, a local charity: "I intend to join the mailing list of an organization like *Innocence Canada*", "I intend to read up on wrongful incarceration", and "I intend to donate to an organization like *Innocence Canada*" ($\alpha = `r printnum(alpha_intention$alpha)`$). All NAM-TPB items were rated on a 7-point scale ranging from 1 ("strongly disagree") to 7 ("strongly agree") and were averaged within each construct.

#### Supportive behaviour

At the end of the event, we observed whether participants took a flyer of *Innocence Canada* (in-person: paper flyer; livestream: digital download), and whether they signed up for their mailing list. We also provided opportunities to donate (in-person: donation box; livestream: donation link). Because we were ethically not allowed to observe donations directly, we followed up with participants one to two weeks after the event to ask whether and how much they had donated. Note that the *Innocents* performance and film were created in the USA, informed by and referring to wrongful imprisonment in the US-American criminal justice system. On the other hand, *Innocence Canada* fights wrongful imprisonment in Canada. Nonetheless, both countries' legal systems face related issues, and the advocacy of *The Innocents* is equally relevant in Canada. Audiences' support for *Innocence Canada*, therefore, further illustrates the advocacy's ability to transfer to a new local context.

#### Affect

We assessed affect with six items rated on a 4-point scale ranging from 1 ("I do not feel it") to 4 ("I feel it strongly"). The six items were combined into three bipolar dimensions alert-tired, relaxed-tense, and positive-negative by subtracting the rating of one pole from the rating of the opposite pole [@schimmack2000].

#### Event experience

We asked participants to rate their experience of the film and the performance in terms of enjoyment, interest, being moved, gaining insight, being attentive, experiencing chills or shivers, tearing up or crying, and likelihood of reengaging with a similar event [cf. @fink2024; @schindler2017; @swarbrick2023]. These items were rated on a 7-point scale ranging from 1 ("not at all") to 7 ("extremely"). Furthermore, we assessed the perceived duration on a 7-point scale from -3 ("much too short") to 3 ("much too long"). For the performance only, we asked participants to describe the performance in up to ten of their own words. At the end of the event, we also asked participants whether they liked the order of film and performance that they saw.

#### Person-level covariates

We assessed participants' age, income, education, and political orientation. Furthermore, based on the Wheel of Power/Privilege [@bauer2021; @duckworth2020; @canadiancouncilforrefugees], we asked participants whether they feel part of equity-deserving groups (Women, genderdiverse, LGBQ+, Indigenous Peoples, and Persons of colour) and inquired about their lived experiences (of disability, justice-involvement, and unshelteredness). We assessed participants' musical background with one item from the Ollen Musical Sophistication Index [@ollen2006; @zhang2019]. Moreover, we asked for participants' familiarity with and preference for contemporary percussion music, on scales ranging from 1 ("very unfamiliar"/"strongly dislike") to 7 ("very familiar"/"strongly like"). We also asked for their motivations to attend the event, and whether they had a personal relationship to the researchers or the artists. Finally, we measured relevant personality traits: Openness to experience with the six-item facet of the Big Five Inventory-2-Short [@soto2017], and trait empathy with 14 items making up the empathic concern and personal distress facets of the Interpersonal Reactivity Index [@davis1980].

### Analysis

All analyses were performed in R 4.5.1 [@R-base]. First, we screened for rushing within each survey component, but no participant was faster than our cutoff criterion of the first quartile minus 1.5 times the interquartile range of the completion times. We further screened for insufficient variance in the response patterns of each participant, which can indicate inattentiveness or dishonesty. For each participant and each multi-item instrument, we calculated the number of unique response values. Responses were excluded if they consisted of only a single repeated value (for instruments with up to 10 items) or only two unique values (for instruments with more items), which was the case for `r print(study1_novariance_observations)` out of `r print(study1_total_instrument_observations)` (`r printnum(study1_novariance_observations/study1_total_instrument_observations, digits = 2)`%) responses. Finally, multi-item indices were only computed if a participant had replied to at least 80% of the items making up that index. The resulting sample size for each analysis is reported alongside the results.

To test the effects of the event on each of the potential drivers of prosociality (closeness, emphatic concern, and problem awareness), we fitted linear mixed models (LMMs) with *lmerTest* [@R-lmerTest]. Sum-to-Zero contrasts tested whether the outcomes were higher for in-person compared to livestream attendance, after watching the performance compared to after the film, and at the end of the event compared to at intermission. We added the baseline rating of the respective outcome as a covariate, estimating a fixed effect for the entire sample to account for measured variances in the outcome prior to the event. We also added random intercepts for each participant to account for unmeasured variances and capture intra-participant correlations due to the repeated measures design. The outcomes and baseline covariates were z-scored. Missing values for the baseline covariate were imputed with zero (the mean value after z-scoring). Control variables that had a sizable correlation with the outcome variables ($r \geq .30$) were included as additional covariates in the models. All models met the assumptions of normally distributed residuals and random intercepts, homogeneity of variances, and did not have multicollinearity issues, unless reported otherwise. The model fit was evaluated against a covariate model predicting the outcome from only the baseline and the random intercept using a Likelihood Ratio Test of the maximum likelihood (ML)-generated models. Main and interaction effects were evaluated using the t-statistic of the parameter estimates and Satterthwaite approximations for degrees of freedom of the restricted maximum likelihood (REML)-generated models, as recommended by @meteyard2020. Cohen's $d$ as effect size measure for the fixed effects was calculated using the equation by [@westfall2014; see @brysbaert2018], and interpreted according to the norms by @cohen1992. Significant interactions were decomposed using one-sided paired t-tests.

To test the influence of closeness, empathic concern, and problem awareness on behavioural intention, we fitted a multiple linear regression with the lm function in the *stats* package. Again, covariates that were sizably correlated with intention were included in the model. All predictors and the outcome were z-scored. Predictors were evaluated with t-test of their regression weights against zero.

To test the influence of intention on observed behaviour, we used ordinal logistic regression with the polr function in *MASS* [@R-MASS] to predict the number of behaviours participants performed. No control variables were sizably correlated with the outcome, and hence no further variables were added to the model. All predictors were z-scored. Predictors were interpreted as having a significant effect if the 95% confidence interval of the Odd's Ratio (calculated as $(Coefficient \pm 1.96*Standard Error)^2$) did not cross 1.

Figures were created with *ggplot2* [@R-ggplot2], *ggpubr* [@R-ggpubr], *ggridges* [@R-ggridges], *ggsignif* [@R-ggsignif], *ggnewscale* [@R-ggnewscale], and *png* [@R-png]. Error bars represent 95% confidence intervals (CI) based on 1000 bootstrap resamples implemented in *Hmisc* [@R-Hmisc].

## Results

In contrast to the affective reactions to typical live entertainment events reported in the literature, participants' positivity, relaxation, and alertness tended to decrease throughout the event. Congruously, both the film and the performance were rated as slightly too long on average. Nonetheless, participants reported high attentiveness, interest, enjoyment, insightfulness, and felt moved and wanted to reengage with similar stimuli, for both the film and the performance, and both in-person and livestream attendance. Feeling chills and tearing up were less common. Interestingly, regardless of whether participants saw the film or the performance first, a majority indicated that they preferred the order they saw the stimuli in over the alternative order, although this preference was stronger among participants who saw the film first and the performance afterwards. For more details regarding participants' self-reported experience, see @apx-eventexperience.

```{r}
#| label: outcome-descriptives
#| include: false

outcomes <- combined_long %>%
  select(p_id, study, attendance, order, timepoint, ios_anna, ios_target, anna_empathic_concern, target_empathic_concern, problem_awareness) %>%
  pivot_wider(id_cols = c(p_id, study, attendance, order), names_from = timepoint, values_from = c(ios_anna, ios_target, anna_empathic_concern, target_empathic_concern, problem_awareness))
```

```{r}
#| label: check-correlations
#| include: false
# get names of multiple choice variables
multichoice_vars <- c(grep("^identity", colnames(study1_2long), value = TRUE), grep("^experience", colnames(study1_2long), value = TRUE), grep("^motivation", colnames(study1_2long), value = TRUE), grep("^relationship", colnames(study1_2long), value = TRUE))

# remove variables that had only missings or character values
multichoice_vars <- setdiff(multichoice_vars, c("relationship_artist", "motivation_other", "motivation_socialjustice_dich"))

# recode multiple choice options as dichotomous variables
study1_dichotom <- study1_3long %>%
  mutate(across(all_of(multichoice_vars), ~ replace(.x, is.na(.x), 0))) 

# define control variables
control_vars <- c("age", "familiarity", "liking", "demo_openness", "trait_empathic_concern", "trait_personal_distress", "income", "education", "omsi", "politics", multichoice_vars)

# Check correlations with control variables
dv_corr("ios_anna", control_vars, study1_dichotom, output = "table")
dv_corr("anna_empathic_concern", control_vars, study1_dichotom, output = "table") 
dv_corr("problem_awareness", control_vars, study1_dichotom, output = "table") # demo_openness r = .30, politics r = .34
dv_corr("behavioural_intention", control_vars, study1_dichotom, output = "table") # liking r = 31, motivation_socialjustice r = .37, trait_empathic_concern r = .34
dv_corr("behavioural_intention", control_vars, subset(study1_dichotom, timepoint == "End"), output = "table") # motivation_socialjustice r = .32, trait_empathic_concern r = .34
dv_corr("behavioural_intention", control_vars, subset(study1_dichotom, timepoint == "Baseline"), output = "table") # liking r = .40, trait_empathic_concern r = .42, motivation_socialjustice r = .39
dv_corr("sum_behaviour", control_vars, subset(study1_dichotom, timepoint == "End"), method = "spearman", output = "table") 

rm(study1_dichotom, control_vars, multichoice_vars)
```

```{r} 
#| label: outcome-lmms
#| include: false

#### Impute means for baseline covariates ###
study1_2long <- study1_2long %>%
  mutate(across(.cols = c(base_ios_anna_z, base_anna_empathic_concern_z, base_problem_awareness_z), 
                .fns = ~ ifelse(is.na(.x), 0, .x)))

#### Closeness LMM ###

# build full model
closeness_lmm <- lmer(ios_anna_z ~ base_ios_anna_z + attendance * medium * timepoint + (1|p_id), data = study1_2long)
# check_assumptions(closeness_lmm, "ios_anna_z", study1_2long) # three outliers violate normality of random intercepts
summary(closeness_lmm)
my_effectsize(closeness_lmm)

# # log-transform does not help:
# study1_2long <- study1_2long %>%
#   mutate(ios_anna_log = log(ios_anna))
# 
# closeness_log <- lmer(ios_anna_log ~ base_ios_anna_z + attendance * medium * timepoint + (1|p_id), data = study1_2long)
# check_assumptions(closeness_log, "ios_anna_log", study1_2long)
# 
# rm(closeness_log)

# # reciprocal transform makes matters worse: 
# study1_2long <- study1_2long %>%
#   mutate(ios_anna_recpr = 1/(ios_anna))
# 
# closeness_recpr <- lmer(ios_anna_recpr ~ base_ios_anna_z + attendance * medium * timepoint + (1|p_id), data = study1_2long)
# check_assumptions(closeness_recpr, "ios_anna_recpr", study1_2long)
# 
# rm(closeness_recpr)
# 
# # Extract random intercepts
# closeness_intercepts <- ranef(closeness_lmm)$p_id
# # Find the indices of the most extreme residuals
# order(closeness_intercepts$`(Intercept)`, decreasing = FALSE)[1:3] # indices: c(47 19 42)
# rownames(closeness_intercepts)[c(47, 19, 42)] # p_id = c("sub-in116", "sub-in019", "sub-in111")
# 
# rm(closeness_intercepts)
# 
# # Excluding the three outlier intercepts did not fix the assumptions
# closeness_lmm <- lmer(ios_anna_z ~ base_ios_anna_z + attendance * medium_2 * timepoint_2 + (1|p_id), data = subset(study1_2long, !(p_id %in% c("sub-in116", "sub-in019", "sub-in111"))))
# check_assumptions(closeness_lmm, "ios_anna_z", subset(study1_2long, !(p_id %in% c("sub-in116", "sub-in019", "sub-in111"))))

# build covariate model
closeness_cov <- lmer(ios_anna_z ~ base_ios_anna_z + (1|p_id), data = study1_2long)



#### Empathy LMM ###

# # build full model
# empathy_lmm <- lmer(anna_empathic_concern_z ~ base_anna_empathic_concern_z + attendance * medium * timepoint + (1|p_id), data = study1_2long)
# check_assumptions(empathy_lmm, "anna_empathic_concern_z", study1_2long) # two outliers violate normality of residuals
# 
# # Extract and standardize residuals
# empathy_residuals <- resid(empathy_lmm, type = "pearson")
# # Find the indices of the most extreme residuals
# order(abs(empathy_residuals), decreasing = TRUE)[1:2] # indices are c(112, 111), but trial & error shows that rows c(113, 114) of study1_2long are the problematic ones
# # Alternatively, plot outlier rows
# lattice::qqmath(empathy_lmm, id=0.1, idLabels=~.obs)
# 
# rm(empathy_residuals)

# build full model (after exclusions)
empathy_lmm <- lmer(anna_empathic_concern_z ~ base_anna_empathic_concern_z + attendance * medium * timepoint + (1|p_id), data = study1_2long[-c(113, 114), ])
# check_assumptions(empathy_lmm, "anna_empathic_concern_z", study1_2long[-c(113, 114), ]) # there are two new outliers
summary(empathy_lmm)
my_effectsize(empathy_lmm)

# build covariate model (after exclusions)
empathy_cov <- lmer(anna_empathic_concern_z ~ base_anna_empathic_concern_z + (1|p_id), data = study1_2long[-c(113, 114), ])



#### Awareness LMM ###

# awareness_lmm <- lmer(problem_awareness_z ~ demo_openness_z + politics_z + base_problem_awareness_z + attendance * medium * timepoint + (1|p_id), data = study1_2long)
# check_assumptions(awareness_lmm, "problem_awareness_z", study1_2long) # residuals & random intercepts violate normality assumption

# log-transform makes matters worse:
# study1_2long <- study1_2long %>%
#   mutate(problem_awareness_log = log(problem_awareness))
# 
# awareness_log <- lmer(problem_awareness_log ~ demo_openness_z + politics_z + base_problem_awareness_z + attendance * medium * timepoint + (1|p_id), data = study1_2long)
# check_assumptions(awareness_log, "problem_awareness_log", study1_2long)
# 
# rm(awareness_log)
# 
# reciprocal transform makes matters worse: 
# study1_2long <- study1_2long %>%
#   mutate(problem_awareness_recpr = 1/(problem_awareness))
# 
# awareness_recpr <- lmer(problem_awareness_recpr ~ demo_openness_z + politics_z + base_problem_awareness_z + attendance * medium * timepoint + (1|p_id), data = study1_2long)
# check_assumptions(awareness_recpr, "problem_awareness_recpr", study1_2long)
# 
# rm(awareness_recpr)

# Extract random intercepts
# awareness_intercepts <- ranef(awareness_lmm)$p_id
# # Find the indices of the most extreme residuals
# order(abs(awareness_intercepts$`(Intercept)`), decreasing = TRUE)[1:2] # indices: c(79, 25)
# rownames(awareness_intercepts)[c(79, 25)] # p_id = c("sub-on107", "sub-in028")
# 
# rm(awareness_intercepts)

# Excluding the two outlier intercepts fixed the assumptions
awareness_lmm <- lmer(problem_awareness_z ~ demo_openness_z + politics_z + base_problem_awareness_z + attendance * medium * timepoint + (1|p_id), data = subset(study1_2long, !(p_id %in% c("sub-on107", "sub-in028")) & !is.na(problem_awareness_z)))
# check_assumptions(awareness_lmm, "problem_awareness_z", subset(study1_2long, !(p_id %in% c("sub-on107", "sub-in028")) & !is.na(problem_awareness_z) ))
summary(awareness_lmm)
my_effectsize(awareness_lmm)

awareness_cov <- lmer(problem_awareness_z ~ demo_openness_z + politics_z + base_problem_awareness_z + (1|p_id), data = subset(study1_2long, !(p_id %in% c("sub-on107", "sub-in028")) & !is.na(problem_awareness_z)))
```

```{r} 
#| label: decompose-interaction
#| include: false

# For closeness and empathy, order (= medium*time) was significant, indicating a carryover effect. 
# to decompose the interaction, test increases from baseline to intermission and intermission to end separated by the two orders, to asses individual effects of the two media:
innocents_posthoctest <- study1_3long %>%
  dplyr::select(c(p_id, attendance, order, timepoint, ios_anna, anna_empathic_concern, problem_awareness)) %>%
  pivot_wider(names_from = timepoint, values_from = c(ios_anna, anna_empathic_concern, problem_awareness))

# Closeness
# increase of film in 1st half
(( ios_1sthalf_film <- t.test(subset(innocents_posthoctest, order == "Film first")$ios_anna_Intermission, subset(innocents_posthoctest, order == "Film first")$ios_anna_Baseline, paired = TRUE, alternative = "greater") ))

(( ios_1sthalf_film_d <- effsize::cohen.d(subset(innocents_posthoctest, order == "Film first")$ios_anna_Intermission, subset(innocents_posthoctest, order == "Film first")$ios_anna_Baseline, paired = TRUE, na.rm = TRUE) )) # rather than just d = t / sqrt(n), this function corrects for the correlation of the two samples

# increase of performance in 1st half
(( ios_1sthalf_perf <- t.test(subset(innocents_posthoctest, order == "Perf first")$ios_anna_Intermission, subset(innocents_posthoctest, order == "Perf first")$ios_anna_Baseline, paired = TRUE, alternative = "greater") ))

(( ios_1sthalf_perf_d <- effsize::cohen.d(subset(innocents_posthoctest, order == "Perf first")$ios_anna_Intermission, subset(innocents_posthoctest, order == "Perf first")$ios_anna_Baseline, paired = TRUE, na.rm = TRUE) ))

# increase of performance in 2nd half
(( ios_2ndhalf_perf <- t.test(subset(innocents_posthoctest, order == "Film first")$ios_anna_End, subset(innocents_posthoctest, order == "Film first")$ios_anna_Intermission, paired = TRUE, alternative = "greater") ))

(( ios_2ndhalf_perf_d <- effsize::cohen.d(subset(innocents_posthoctest, order == "Film first")$ios_anna_End, subset(innocents_posthoctest, order == "Film first")$ios_anna_Intermission, paired = TRUE, na.rm = TRUE) ))

# increase of film in 2nd half
(( ios_2ndhalf_film <- t.test(subset(innocents_posthoctest, order == "Perf first")$ios_anna_End, subset(innocents_posthoctest, order == "Perf first")$ios_anna_Intermission, paired = TRUE, alternative = "greater") ))

(( ios_2ndhalf_film_d <- effsize::cohen.d(subset(innocents_posthoctest, order == "Perf first")$ios_anna_End, subset(innocents_posthoctest, order == "Perf first")$ios_anna_Intermission, paired = TRUE, na.rm = TRUE) ))


# Empathy
# increase of film in 1st half
(( ec_1sthalf_film <- t.test(subset(innocents_posthoctest, order == "Film first")$anna_empathic_concern_Intermission, subset(innocents_posthoctest, order == "Film first")$anna_empathic_concern_Baseline, paired = TRUE, alternative = "greater") ))

(( ec_1sthalf_film_d <- effsize::cohen.d(subset(innocents_posthoctest, order == "Film first")$anna_empathic_concern_Intermission, subset(innocents_posthoctest, order == "Film first")$anna_empathic_concern_Baseline, paired = TRUE, na.rm = TRUE) ))

# increase of performance in 1st half
(( ec_1sthalf_perf <- t.test(subset(innocents_posthoctest, order == "Perf first")$anna_empathic_concern_Intermission, subset(innocents_posthoctest, order == "Perf first")$anna_empathic_concern_Baseline, paired = TRUE, alternative = "greater") ))

(( ec_1sthalf_perf_d <- effsize::cohen.d(subset(innocents_posthoctest, order == "Perf first")$anna_empathic_concern_Intermission, subset(innocents_posthoctest, order == "Perf first")$anna_empathic_concern_Baseline, paired = TRUE, na.rm = TRUE) ))

# increase of performance in 2nd half
(( ec_2ndhalf_perf <- t.test(subset(innocents_posthoctest, order == "Film first")$anna_empathic_concern_End, subset(innocents_posthoctest, order == "Film first")$anna_empathic_concern_Intermission, paired = TRUE, alternative = "greater") ))

(( ec_2ndhalf_perf_d <- effsize::cohen.d(subset(innocents_posthoctest, order == "Film first")$anna_empathic_concern_End, subset(innocents_posthoctest, order == "Film first")$anna_empathic_concern_Intermission, paired = TRUE, na.rm = TRUE) ))

# increase of film in 2nd half
(( ec_2ndhalf_film <- t.test(subset(innocents_posthoctest, order == "Perf first")$anna_empathic_concern_End, subset(innocents_posthoctest, order == "Perf first")$anna_empathic_concern_Intermission, paired = TRUE, alternative = "greater") ))

(( ec_2ndhalf_film_d <- effsize::cohen.d(subset(innocents_posthoctest, order == "Perf first")$anna_empathic_concern_End, subset(innocents_posthoctest, order == "Perf first")$anna_empathic_concern_Intermission, paired = TRUE, na.rm = TRUE) ))

# For problem awareness, the interaction of time and medium was not significant. Hence, only one posthoc test is required to test the increase from baseline to intermission:
(( pa_1sthalf <- t.test(innocents_posthoctest$problem_awareness_Intermission, innocents_posthoctest$problem_awareness_Baseline, paired = TRUE, alternative = "greater") ))

(( pa_1sthalf_d <- effsize::cohen.d(innocents_posthoctest$problem_awareness_Intermission, innocents_posthoctest$problem_awareness_Baseline, paired = TRUE, na.rm = TRUE) ))
```

### Awareness

We evaluated the effects of the event conditions on *awareness* of wrongful imprisonment, *empathy* with the wrongfully imprisoned Anna Vasquez, and *closeness* with Anna Vasquez (Hypotheses 1a, 2a, and 3a), using LMMs. Higher openness to experience was moderately associated with higher awareness (`r apa_print(cor.test(study1_3long$problem_awareness, study1_3long$demo_openness, method = "spearman"))$full_result`), as was more left-leaning political orientation (`r apa_print(cor.test(study1_3long$problem_awareness, study1_3long$politics, method = "spearman"))$full_result`). Both variables were therefore included as covariates in the LMM, resulting in the formula $Awareness \sim Openness + Politics + Baseline + Attendance * Stimulus * Time + (1|Participant)$. For all three outcomes (awareness, empathy, and closeness), the baseline significantly predicted the outcome, but the data were significantly more likely under the full model including the event conditions, compared to a model with just the covariates and the random intercept (for the full model details and model comparisons see @apx-modelcomps). 

The main effect and interactions involving the stimulus were not significant, indicating no difference in problem awareness between participants who had seen the performance compared to the film. Thus, the data did not support Hypothesis 1a. The only significant fixed effect was a small main effect of time, `r eval_fixed(awareness_lmm, "timepointEndvsInter")`, with participants reporting higher problem awareness at the end of the event (`r print_descr(outcomes[outcomes$study=="Study 1", ]$problem_awareness_End)`) compared to intermission (`r print_descr(outcomes[outcomes$study=="Study 1", ]$problem_awareness_Intermission)`), regardless of stimulus and attendance mode. An additional post-hoc test revealed that the increase from baseline (`r print_descr(outcomes[outcomes$study=="Study 1", ]$problem_awareness_Baseline)`) to intermission was also small but significant, `r apa_print(pa_1sthalf)$full_result`, $d = `r printnum(pa_1sthalf_d$estimate)`$ (see @fig-awareness). 

```{r}
#| label: fig-awareness
#| fig-cap: Problem Awareness Throughout the Event
#| apa-note: Mean and CI of awareness by stimulus (x-axis), split for the in-person (left) and livestream (middle) audience of study 1, and the stream audience of study 2 (right). Awareness was rated on a scale ranging from 1 (strongly disagree) to 7 (strongly agree). Significance levels refer to one-sided pairwise t-tests. $p* < .05$, $** p < .01$, $*** p < .001$, n.s. = not significant.
#| echo: false
#| warning: false

# TODO add sample size on x-axis
# TODO add significance stars for post-hoc tests

plot_meanSE(df = combined_long, dv = "jitter_awareness", ylab = "Problem Awareness", xlab = "Stimulus") + facet_wrap(vars(facet), scales = "free") +
  theme(aspect.ratio = 1.3)
```

### Empathy 

Empathic concern for Anna Vasquez did not have any correlations with the control variables that were at least moderately sized. Therefore, no further covariates were included in the LMM $Empathy \sim Baseline + Attendance * Stimulus * Time + (1|Participant)$. The main effect and interactions involving attendance were not significant, indicating no difference in empathy between in-person and livestream audiences. Thus, the data did not support Hypothesis 2a. Time had a moderate effect on empathy, `r eval_fixed(empathy_lmm, "timepointEndvsInter")`, with higher empathy ratings at the end of the event (`r print_descr(outcomes[outcomes$study=="Study 1", ]$anna_empathic_concern_End)`) compared to intermission (`r print_descr(outcomes[outcomes$study=="Study 1", ]$anna_empathic_concern_Intermission)`). The main effect of time interacted moderately with medium, `r eval_fixed(empathy_lmm, "mediumPerfvsFilm:timepointEndvsInter")`. Decomposing the interaction revealed that compared to the empathy ratings at baseline (`r print_descr(outcomes[outcomes$study=="Study 1", ]$anna_empathic_concern_Baseline)`), seeing the film in the first half of the event afforded a small increase in empathy (`r print_descr(subset(outcomes, study=="Study 1" & order == "Film-Perf")$anna_empathic_concern_Intermission)`, `r apa_print(ec_1sthalf_film)$full_result`, $d = `r printnum(ec_1sthalf_film_d$estimate)`$). In contrast, seeing the performance in the first half did not lead to a significant change in empathy (`r print_descr(subset(outcomes, study=="Study 1" & order == "Perf-Film")$anna_empathic_concern_Intermission)`, `r apa_print(ec_1sthalf_perf)$full_result`, $d = `r printnum(ec_1sthalf_perf_d$estimate)`$). In the second half of the event, seeing the performance after the film afforded a small increase in empathy (`r print_descr(subset(outcomes, study=="Study 1" & order == "Film-Perf")$anna_empathic_concern_End)`, `r apa_print(ec_2ndhalf_perf)$full_result`, $d = `r printnum(ec_2ndhalf_perf_d$estimate)`$), compared to a moderate increase when the seeing film after the performance (`r print_descr(subset(outcomes, study=="Study 1" & order == "Perf-Film")$anna_empathic_concern_End)`, `r apa_print(ec_2ndhalf_film)$full_result`, $d = `r printnum(ec_2ndhalf_film_d$estimate)`$; see @fig-empathy). 

```{r}
#| label: fig-empathy
#| fig-cap: Empathic Concern Throughout the Event
#| apa-note: Mean and CI of empathy by stimulus (x-axis), split for the in-person (left) and livestream (middle) audience of study 1, and the stream audience of study 2 (right). Empathy was rated on a scale ranging from 1 (not at all) to 7 (extremely). Significance levels refer to one-sided pairwise t-tests. $p* < .05$, $** p < .01$, $*** p < .001$, n.s. = not significant.
#| out-width: 100%
#| echo: false
#| warning: false

# TODO add sample size on x-axis
# TODO add significance stars for post-hoc tests

plot_meanSE(df = combined_long, dv = "jitter_anna_empathy", ylab = "Empathic Concern", xlab = "Stimulus") + facet_wrap(vars(facet), scales = "free") +
  theme(aspect.ratio = 1.3)
```

### Closeness

Relationship closeness with Anna Vasquez did not have any sizable correlations with the control variables. Similarly to the empathy model, the closeness LMM with the formula $Closeness \sim Baseline + Attendance * Stimulus * Time + (1|Participant)$ did not feature any significant main or interaction effects involving attendance. The lack of a difference in relationship closeness between in-person and livestream audiences did not support Hypothesis 3a. The stimulus had a small but significant effect on closeness, with participants reporting lower closeness after seeing the performance (`r print_descr(study1_df$perfo_ios_anna)`) than after the film (`r print_descr(study1_df$docu_ios_anna)`, `r eval_fixed(closeness_lmm, "mediumPerfvsFilm")`). Time also had a small effect, with higher closeness at the end of the event (`r print_descr(outcomes[outcomes$study=="Study 1", ]$ios_anna_End)` than at intermission (`r print_descr(outcomes[outcomes$study=="Study 1", ]$ios_anna_Intermission)`, `r eval_fixed(closeness_lmm, "timepointEndvsInter")`). Importantly, stimulus and time interacted moderately, `r eval_fixed(closeness_lmm, "mediumPerfvsFilm:timepointEndvsInter")`. Decomposing the interaction revealed that compared to closeness at baseline (`r print_descr(subset(outcomes, study=="Study 1")$ios_anna_Baseline)`), seeing the film in the first half of the event afforded a large increase in closeness (`r print_descr(subset(outcomes, study=="Study 1" & order == "Film-Perf")$ios_anna_Intermission)`, `r apa_print(ios_1sthalf_film)$full_result`, $d = `r printnum(ios_1sthalf_film_d$estimate)`$). In contrast, seeing the performance by itself only afforded a small increase (`r print_descr(subset(outcomes, study=="Study 1" & order == "Perf-Film")$ios_anna_Intermission)`, `r apa_print(ios_1sthalf_perf)$full_result`, $d = `r printnum(ios_1sthalf_perf_d$estimate)`$). In the second half, seeing the performance after the film resulted in no significant changes in closeness (`r print_descr(subset(outcomes, study=="Study 1" & order == "Film-Perf")$ios_anna_End)`, `r apa_print(ios_2ndhalf_perf)$full_result`, $d = `r printnum(ios_2ndhalf_perf_d$estimate)`$), but the film after the performance led to a moderate increase (`r print_descr(subset(outcomes, study=="Study 1" & order == "Perf-Film")$ios_anna_End)`, `r apa_print(ios_2ndhalf_film)$full_result`, $d = `r printnum(ios_2ndhalf_film_d$estimate)`$; see @fig-closeness). 

```{r}
#| label: fig-closeness
#| fig-cap: Relationship Closeness Throughout the Event
#| apa-note: Mean and CI of closeness by stimulus (x-axis), split for the in-person (left) and livestream (middle) audience of study 1, and the stream audience of study 2 (right). Closeness was rated on a visual analog scale ranging from 1 (0% overlap) to 7 (90% overlap). Significance levels refer to one-sided pairwise t-tests. $p* < .05$, $** p < .01$, $*** p < .001$, n.s. = not significant.
#| echo: false
#| warning: false

# TODO add sample size on x-axis
# TODO add significance stars for post-hoc tests

plot_meanSE(df = combined_long, dv = "jitter_ios_anna", ylab = "Relationship Closeness", xlab = "Stimulus") + facet_wrap(vars(facet), scales = "free") +
  theme(aspect.ratio = 1.3)
```

### Charitable Behaviour

```{r}
#| label: regression-intention-predictors
#| include: false

rm(ec_1sthalf_film, ec_1sthalf_film_d, ec_1sthalf_perf, ec_1sthalf_perf_d, ec_2ndhalf_film, ec_2ndhalf_film_d, ec_2ndhalf_perf, ec_2ndhalf_perf_d, innocents_posthoctest, ios_1sthalf_film, ios_1sthalf_film_d, ios_1sthalf_perf, ios_1sthalf_perf_d, ios_2ndhalf_film, ios_2ndhalf_film_d, ios_2ndhalf_perf, ios_2ndhalf_perf_d, outcomes, pa_1sthalf, pa_1sthalf_d)

#### STUDY 1 ###
study1_intent <- study1_2long %>%
  filter(timepoint == "End" & !is.na(ios_anna_z) & !is.na(anna_empathic_concern_z) & !is.na(problem_awareness_z)) # only use end data

# intention_outcomes <- lm(behavioural_intention_z ~ trait_empathic_concern_z + motivation_socialjustice_dich + ios_anna_z + anna_empathic_concern_z + problem_awareness_z, data = study1_intent)
# 
# check_assumptions(intention_outcomes, "behavioural_intention_z", study1_intent) # residuals are not normal
# 
# # try log-scaling
# study1_intent$behavioural_intention_log <- log(study1_intent$behavioural_intention)
# intention_outcomes <- lm(behavioural_intention_log ~ trait_empathic_concern_z + motivation_socialjustice_dich + ios_anna_z + anna_empathic_concern_z + problem_awareness_z, data = study1_intent)
# check_assumptions(intention_outcomes, "behavioural_intention_log", study1_intent) # much worse
# 
# # try reciprocal
# study1_intent$behavioural_intention_recpr <- 1/(study1_intent$behavioural_intention)
# intention_outcomes <- lm(behavioural_intention_recpr ~ trait_empathic_concern_z + motivation_socialjustice_dich + ios_anna_z + anna_empathic_concern_z + problem_awareness_z, data = study1_intent)
# check_assumptions(intention_outcomes, "behavioural_intention_recpr", study1_intent) # also terrible
# 
# # extract residuals
# intention_residuals <- resid(intention_outcomes, type = "pearson")
# # Find the indices of the most extreme residuals
# order(abs(intention_residuals), decreasing = TRUE)[1:3] # indices are c(69, 71, 3), but trial & error shows that rows c(74, 76, 4) are the problematic ones

# build model after exclusions
intention_outcomes <- lm(behavioural_intention_z ~ trait_empathic_concern_z + motivation_socialjustice_dich + ios_anna_z + anna_empathic_concern_z + problem_awareness_z, data = study1_intent[-c(74, 76), ])
# check_assumptions(intention_outcomes, "behavioural_intention_z", study1_intent[-c(74, 76), ]) # shapiro-wilk is still significant, but Q-Q plot looks much better
  
# summary(intention_outcomes)
intention_outcomes_table <- apa_print(intention_outcomes)$table

# calculate the effect size of empathy, requires a model excluding empathy https://www.researchgate.net/post/Which-effect-size-estimate-should-I-use-for-a-linear-regression-with-a-continuous-dep-variable-dichotomous-indep-variable-and-covariates
intention_outcomes_dropempathy <- lm(behavioural_intention_z ~ trait_empathic_concern_z + motivation_socialjustice_dich + ios_anna_z + problem_awareness_z, data = study1_intent[-c(71, 73), ])

empathy_f2 <- (summary(intention_outcomes)$r.squared - summary(intention_outcomes_dropempathy)$r.squared) / (1 - summary(intention_outcomes)$r.squared)



#### STUDY 2 ###

# z-score covariate
study2_long <- study2_long %>%
  mutate(liking_z = my_z_score(liking))

# only use end data
study2_intent <- study2_long %>%
  filter(timepoint == "End") 

study2_intention_outcomes <- lm(behavioural_intention_z ~ liking_z + ios_anna_z + anna_empathic_concern_z + problem_awareness_z, data = study2_intent)
# check_assumptions(study2_intention_outcomes, "behavioural_intention_z", study2_intent)
study2_intention_target <- lm(behavioural_intention_z ~ liking_z + ios_anna_z + ios_target_z + anna_empathic_concern_z + target_empathic_concern_z + problem_awareness_z, data = study2_intent)
# check_assumptions(study2_intention_target) # empathy variables have heightened VIFs, but nothing problematic (all VIF < 5)

# calculate the effect size of problem awareness, requires a model excluding empathy https://www.researchgate.net/post/Which-effect-size-estimate-should-I-use-for-a-linear-regression-with-a-continuous-dep-variable-dichotomous-indep-variable-and-covariates
study2_intention_target_dropawareness <- lm(behavioural_intention_z ~ liking_z + ios_anna_z + ios_target_z + anna_empathic_concern_z + target_empathic_concern_z, data = study2_intent)

awareness_f2 <- (summary(study2_intention_target)$r.squared - summary(study2_intention_target_dropawareness)$r.squared) / (1 - summary(study2_intention_target)$r.squared)
```

After establishing that the event increased audiences' awareness, empathy, and closeness, we evaluated the influence of these variables on the intention to support a charity that fights wrongful imprisonment (Hypotheses 1b, 2b, and 3b). Participants with higher trait empathic concern tended to have higher charitable intentions at the end of the event (`r apa_print(cor.test(study1_intent$trait_empathic_concern, study1_intent$behavioural_intention, method = "spearman"))$full_result`), as did participants who selected helping the social justice cause among their motivations to get a ticket for the event (`r apa_print(cor.test(study1_intent$motivation_socialjustice, study1_intent$behavioural_intention, method = "spearman"))$full_result`). <!-- should prolific participants be excluded from the motivation data, since they didn't buy a ticket? --> The variables were thus controlled for in the multiple linear regression $Intention \sim Trait Empathic Concern + Social Justice Motivation + Closeness + State Empathic Concern + Problem Awareness$ using just the data from the end of the event. State empathic concern significantly predicted intention with a moderate effect ($\beta = `r printnum(coef(summary(intention_outcomes))["anna_empathic_concern_z", "Estimate"])`$, $t (`r printnum(nobs(intention_outcomes) - summary(intention_outcomes)$fstatistic[2] - 1, digits = 0)`) = `r printnum(coef(summary(intention_outcomes))["anna_empathic_concern_z", "t value"])`$, $p < .001$, $f^2 = `r printnum(empathy_f2)`$) after controlling for differences in the covariates. In other words, participants who felt more empathic concern had a stronger intention to perform charitable behaviour, supporting Hypothesis 2b. In contrast to the predictions of Hypotheses 1b and 3b, problem awareness and relationship closeness did not significantly predict intention (both $b < .1$, $p > .3$). The total explained variance in intention was $R_{adj}^2 = `r printnum(summary(intention_outcomes)$adj.r.squared)`$ (see @tab-regression-intention).

```{r}
#| label: tab-regression-intention
#| apa_note: After excluding two data points that violated the normality of the model residuals, the model for study 1 included $N = `r nrow(intention_outcomes$model)`$ observations. 
#| echo: false

# TODO manually copy this html table into the word doc or adjust styling inthe doc
tab_model(intention_outcomes, study2_intention_outcomes, study2_intention_target, show.ci = FALSE, 
          pred.labels = c("Intercept", "Trait Empathic Concern", "Social Justice Motivation", "Closeness (Anna)", "Empathic Concern (Anna)", "Problem Awareness", "Closeness (Acquaintance)", "Empathic Concern (Acquaintance)"), 
          dv.labels = c("Study 1", "Study 2 (1. Step)", "Study 2 (2. Step)"))

# Alternatively, use flextable BUT doesn't take math formulas, formatting might be a pain
# apa_print(intention_outcomes)$table %>%
#   select(term, estimate, p.value) %>%
#   mutate(term = c("Intercept", "Trait Empathic Concern", "Social Justice Motivation", "Closeness (Anna)", "Empathic Concern (Anna)", "Problem Awareness")) %>%
#   flextable() %>%
#   flextable::add_header_row(
#     values = c("", "Study 1"),
#     colwidths = c(1, 2)
#   ) %>%
#   flextable::align(i = 1, j = 2:3, align = "center", part = "header") %>%
#   flextable::add_body_row(top = FALSE, 
#                           values = c("$N$", nrow(intention_outcomes$model)),
#                           colwidths = c(1, 2)
#   ) %>%
#   flextable::add_body_row(top = FALSE, 
#                           values = c("$R^2_{adjusted}$", printnum(r2(intention_outcomes)$R2_adjusted, digits = 3)),
#                           colwidths = c(1, 2)
#   ) 
```

```{r}
#| label: regression-behaviour-intention
#| include: false

# filter dataframe (assigning the df object is required for computing the model r2)
study1_behav <- study1_2long %>%
  filter(timepoint == "End") %>% # only use variables at the end of the event
  filter(completed == TRUE) %>% # only use participants who completed the event
  filter(!is.na(sum_behaviour)) # remove NAs
# if comparing nested models with anova(), also exclude NAs in other predictors:  & !is.na(ios_anna_z) & !is.na(empathic_concern_z) & !is.na(problem_awareness_z)

# behaviour ~ intention
sumbehav_intention <- MASS::polr(sum_behaviour_fact ~ attendance + order + behavioural_intention_z, data = study1_behav, Hess = TRUE)

# store OR values in an object 
sumbehav_intention_OR <- get_OR_CI(sumbehav_intention)

# calculate delta R2
# r2_nagelkerke(sumbehav_intention)


# Compare intention before and after the event
sumbehav_endintention <- polr(sum_behaviour_fact ~ behavioural_intention_z, data = study1_behav, Hess = TRUE)
sumbehav_baseintention <- polr(sum_behaviour_fact ~ base_behavioural_intention_z, data = study1_behav, Hess = TRUE)

sumbehav_baseintention_OR <- get_OR_CI(sumbehav_baseintention)

# r2_nagelkerke(sumbehav_endintention)
# r2_nagelkerke(sumbehav_baseintention)
```

At the end of the event, we assessed three charitable behaviours supporting the charity *Innocence Canada*. Among the participants who completed the event, `r sum(study1_df$behaviour_dich, na.rm = T)` (`r printnum(sum(study1_df$behaviour_dich, na.rm = T)/sum(!is.na(study1_df$behaviour_dich))*100)`%) performed at least one behaviour: `r sum(study1_df$flyer, na.rm = T)` participants took an *Innocence Canada* flyer, `r sum(study1_df$mailing, na.rm = T)` signed up to their mailing list, and `r sum(study1_df$post_donation, na.rm = T)` made a donation, raising a total of CAD `r sum(study1_df$donation_amount, na.rm = T)` (see @fig-waffle-behaviour). To test whether participants' charitable intentions were implemented in actual behaviour (Hypothesis 4), we calculated a sum score of behaviours for participants with applicable values (yes or no) on all three behaviours ($n = `r sum(!is.na(study1_df$sum_behaviour))`$). A logistic regression with the formula $Behaviours \sim Attendance + Order + Intention$ revealed that in-person participants demonstrated more behaviours (`r print_descr(subset(study1_df, attendance == "In-person")$sum_behaviour)`) than participants watching the livestream (`r print_descr(subset(study1_df, attendance == "Livestream")$sum_behaviour)`, `r paste0("$OR = ", round(sumbehav_intention_OR["attendanceInpersonvsStream", "OR"], 2), "$, 95% CI [", round(sumbehav_intention_OR["attendanceInpersonvsStream", "CI_lower"], 2), ", ", round(sumbehav_intention_OR["attendanceInpersonvsStream", "CI_upper"], 2), "]")`). The sum of behaviours did not differ between participants who saw the film first (`r print_descr(subset(study1_df, order == "Film first")$sum_behaviour)`) compared to those who saw the performance first (`r print_descr(subset(study1_df, order == "Perf first")$sum_behaviour)`, `r paste0("$OR = ", round(sumbehav_intention_OR["orderFPvsPF", "OR"], 2), "$, 95% CI [", round(sumbehav_intention_OR["orderFPvsPF", "CI_lower"], 2), ", ", round(sumbehav_intention_OR["orderFPvsPF", "CI_upper"], 2), "]")`). Crucially, participants with higher intentions at the end of the event tended to demonstrate more behaviours (`r paste0("$OR = ", round(sumbehav_intention_OR["behavioural_intention_z", "OR"], 2), "$, 95% CI [", round(sumbehav_intention_OR["behavioural_intention_z", "CI_lower"], 2), ", ", round(sumbehav_intention_OR["behavioural_intention_z", "CI_upper"], 2), "]")`), supporting Hypothesis 4. The model explained a behavioural variance of $R_{Nagelkerke}^2 = `r printnum(r2_nagelkerke(sumbehav_endintention))`$. 

```{r}
#| label: fig-waffle-behaviour
#| fig-cap: Charitable Behaviour Counts
#| apa-note: Split for in-person and livestream audiences of study 1, and film and performance audiences of study 2 (from left to right). Note that participants in study 1 who did not complete the event were excluded from this analysis. For mailing, 'not applicable' refers to participants who indicated that they were already signed up to the mailing list of the charity. For donation, 'not applicable' refers to participants who did not participate in the follow-up survey asking about donation behaviour.
#| out-width: 100%
#| echo: false

behaviour_df <- combined_long %>%
  filter(study == "Study 2" | completed == TRUE) %>% # for study 1, exclude drop-outs
  filter(timepoint == "End") %>% # only use data at end
  select(p_id, study, attendance, medium, flyer, mailing, donation) %>%
  # new faceting: Study 1 In-person vs Livestream; Study 2 Film vs Performance
  mutate(facet = ifelse(study == "Study 1", paste(study, attendance),
                        paste(study, medium)),
         facet = factor(facet, levels = c("Study 1 In-person", "Study 1 Livestream", "Study 2 Film", "Study 2 Performance"))) %>%
  pivot_longer(cols = c(flyer, mailing, donation), 
               names_to = "Behaviour",
               values_to = "Response") %>%
  mutate(Behaviour = factor(Behaviour, levels = c("flyer", "mailing", "donation"), labels = c("Flyer", "Mailing", "Donation")),
         Response = replace(Response, is.na(Response), -9),
         Response = factor(Response, levels = c(1, 0, -9), labels = c("Yes", "No", "Not applicable"))) %>%
  group_by(facet, Behaviour, Response) %>%
  summarise(Count = n(), .groups = "drop") %>%
  ungroup() 

ggplot(data = behaviour_df,
       aes(fill = Response, values = Count)) +
  geom_waffle(color = "black",
              size = 0.5,
              n_rows = 3) +
  scale_fill_manual(values = c("#002060", "#BEBEBE", "white")) +
  facet_grid(vars(Behaviour), vars(facet), scales = "free") +
  theme_bw() +
  theme(legend.position = "top",
        panel.grid = element_blank(),
        axis.text = element_blank(),
        axis.ticks = element_blank())
```

It is important to note that participants' charitable intentions only increased minimally from baseline (`r print_descr(subset(study1_3long, timepoint == "Baseline")$behavioural_intention)`) to the end of the event (`r print_descr(subset(study1_3long, timepoint == "End")$behavioural_intention)`, `r apa_print(t.test(subset(study1_3long, timepoint == "Baseline")$behavioural_intention, subset(study1_3long, timepoint == "End")$behavioural_intention, paired = T))$full_result`). Did the event matter at all for participants' charitable behaviour, or was their behaviour already determined by their intentions prior to attending the event? We compared the predictive power of intention before and after the event with two separate logistic regressions. Baseline intention significantly predicted the sum of behaviours, although with a smaller effect than intention at the end of the event (`r paste0("$OR = ", round(sumbehav_baseintention_OR["base_behavioural_intention_z", "OR"], 2), "$, 95% CI [", round(sumbehav_baseintention_OR["base_behavioural_intention_z", "CI_lower"], 2), ", ", round(sumbehav_baseintention_OR["base_behavioural_intention_z", "CI_upper"], 2), "]")`). Importantly, baseline intention explained much less variance in behaviour ($R_{Nagelkerke}^2 = `r printnum(performance::r2_nagelkerke(sumbehav_baseintention))`$) compared to intention at the end of the event.

## Discussion

In summary, the film and the performance increased participants' closeness and empathy with a wrongfully imprisoned person, and problem awareness regarding wrongful imprisonment. Comparing the relevance of these variables revealed that empathy predicted charitable intentions, coherent with the empathy-altruism hypothesis. Intentions, in turn, predicted participants' actual support of a charity fighting wrongful imprisonment. Contrary to our hypotheses, we found no differences between in-person and livestream participants, suggesting that the advocacy effects were independent of shared presence with other audience members or with the performers (in the case of the performance). Unexpectedly, we found that the film led to stronger increases in empathy and closeness compared to the performance. However, this difference between the stimuli might be confounded with the specific wrongfully imprisoned person towards whom empathy and closeness was assessed: The measures of empathy and closeness both require a reference person who is presented to the participants in a vignette and who the items refer to (e.g., "How compassionate do you feel when thinking of this person?"). In study 1, participants rated their empathy and closeness towards a vignette of Anna Vasquez as reference person, because her case as presented in the film lent itself well to using in the survey. We did not consider that participants would be exposed to Anna Vasquez and would become familiar with her during the film, in which she is one of the protagonists, but not during the performance, in which her name is only once mentioned briefly. Since familiarity can influence empathy (CITE) and closeness (CITE), familiarity might confound the higher ratings in empathy and closeness after seeing the film. 

The film's advantage in increasing empathy (or, potentially, familiarity) with Anna Vasquez, combined with our finding that empathy predicted the intention to support a related charity, raises another question: Did the film play a larger role in mobilizing supportive behaviour than the performance? The crossover design of study 1, where behaviour was assessed only once after seeing both stimuli, does not allow us to compare the behavioural effects of the film and the performance. Following these considerations, study 2 aims to address the potential familiarity confound and to disambiguate the behavioural effects of the two stimuli, while replicating the findings from the live concert setting in a larger-scale online study.

# Study 2

Given that in-person and livestream participants in study 1 reported comparable experiences, in study 2 we only recruited online participants. Participants were presented with either the *Innocents* film or performance and deceived into believing that they were watching a livestream in real time (rather than a recording), to mimic the live event character of study 1. This procedure allowed us to collect data over an extended time period, and thus to recruit a larger sample for a well-powered comparison between the two stimuli. The measures were mostly the same as in study 1, with additional empathy and closeness measures using a vignette of a hypothetical victim of wrongful imprisonment who appears neither in the film nor in the performance, to avoid that familiarity with the rated person would confound the comparison between stimuli. We tested the following hypotheses:

1. Based on the findings from study 1, we expected that watching the film or the performance would afford similar increases in problem awareness.
2. Based on study 1, we expected that the film would afford larger increases in closeness and empathy with Anna Vasquez. However, assuming that this difference was confounded by familiarity, we expected that both stimuli would afford similar increases in closeness and empathy with a hypothetical victim (2a). We expected to replicate the study 1 finding that empathy predicts charitable intentions, but expected empathy with a hypothetical victim to be a stronger predictor than empathy with Anna Vasquez, given the potential confound in the latter measure (2b).
3. We expected to replicate the effect of charitable intentions on actual behaviour in support of a charity that fights wrongful imprisonment (3a). Given that we expected comparable effects of the film and the performance on empathy with a hypothetical victim as predictor of intentions, we also expected comparable effects of the film and the performance on actual behaviour (3b).

Finally, we wanted to explore whether watching just one of the stimuli would be less effective than watching both the film and the performance. Therefore, we compared the results of study 2 with those of study 1, with the following hypotheses:

4. Participants who only watched one stimulus (study 2) would report smaller increases in problem awareness, empathy, and closeness than participants having watched both stimuli (study 1).
5. Participants who only watched one stimulus would perform less charitable behaviour than participants having wathced both stimuli.

## Method

Study 2 manipulated one factor with two levels: Participants watched either the film or the performance. Accordingly, there were only two measurement time points, before and after watching. All participants watched a stream at home, so Study 2 followed many of the same methods used for the livestream audience in Study 1. The methods for Study 2 were preregistered at OSF on June 18th, 2025 (see <https://osf.io/suyef/>), and any deviations from the preregistration are reported here. The OSF repository also contains the survey. <!-- TODO and data and analysis code? -->

### Participants

<!-- TODO after data collection: fill in final sample size. If smaller than 200, conduct sensitivity analysis? -->

<!-- TODO describe pertinent characteristics, refer to suppl for detailed tables -->

For Study 2, we recruited all participants through Prolific between June and September 2025. For the first half of the sample, the study was open Tuesday through Sunday evening roughly between 5:30 and 8:30 pm Eastern Time to imitate the conditions of a livestreamed event as in Study 1. Because this slowed the data collection more than anticipated, for the second half of the sample, paticipants could access the study at any time. Participants had to be between 18 and 60 years old, be fluent in English, have healthy hearing, watch the event without glasses (healthy vision or correction with contact lenses), have not seen the film or the performance before, and reside in Canada. We added the last requirement to match the area of activity of our partner charity, Innocence Canada. We aimed to recruit 200 participants, 100 per condition. A simulation-based power analysis indicated that this sample size would yield a 75% power to detect the most ambiguous effect from Study 1, the interaction of medium and time on empathic concern (see preregistration for details). A total of xyz participants started the study and `r nrow(study2_df)` (xyz %) completed it, with `r sum(study2_df$group == "group_film")` participants in the film and `r sum(study2_df$group == "group_perf")` in the performance condition. Upon completion of the study, participants were compensated with 6 GBP per hour.

### Procedure

<!-- TODO after data collection: update how many participants finished components later -->

For Study 2, the pre-survey was administered in the same session as the event stream and the post-survey, though participants who quit the study after one of the components were given the option to finish the remaining component(s) at a later point. Xyz participants filled out the pre-survey first and completed the event stream and post-survey on average x days later, and xyz participants answered the post-survey on average x days after watching the stream. For the remaining majority of participants, the procedure was similar to that used for the impromptu participants of Study 1: After giving informed consent, participants filled out a pre-survey, which assessed a baseline of the behavioural predictors interpersonal closeness, state empathy, problem awareness, and behavioural intentions. Moreover, the pre-survey included the other NAM-TPB variables and an affect measure. Participants then saw a recording of the event stream from Study 1, containing either the film (first half of the April 2nd, 2024, event) or the performance (first half of the April 4th event). After watching the stream, participants rated their event experience and the same measures already assessed at baseline, and finally the person-level covariates. At the end, we asked participants what they thought the study investigated, and we observed behaviour in support of *Innocence Canada*. Study 2 additionally included some new measures described in the next section, as well as some measures that were used to answer other research questions (see preregistration for details). The implementation of the web surveys and the integrated stream was identical to Study 1. Throughout the study, participants were instructed that they would watch a live event, even though they actually watched a recording, to create an experience comparable to the livestream in Study 1. After the study, participants were debriefed about this deception and reconsented to the use of their data. Study 2 was approved by the McMaster Research Ethics Board (#7202).

### Measures

Study 2 assessed the same measures as Study 1 (interpersonal closeness, state empathy, the variables of the NAM and TPB, supportive behaviour, affect, event experience, and person-level covariates), except for the following changes:

#### Interpersonal closeness

As in Study 1, we measured interpersonal closeness with the IOS scale [@aron1992], rated for the same target persons/groups. In addition, participants were asked to imagine an acquaintance and prompted to describe them to make sure they were visualizing a person they actually know [@cialdini1997]. Participants were then asked to imagine that this acquaintance fell victim to wrongful imprisonment (the vignette was modeled after a real case, @verschwele2020; for the full vignette see the OSF repository), and rated their closeness with the acquaintance.

#### State empathy

As in Study 1, participants read a vignette about the wrongful imprisonment of Anna Vasquez and rated their empathic concern and personal distress using the Empathic Concern Index [@batson1987]. In addition, the Empathic Concern Index was also administered after the vignette about the hypothetical wrongful imprisonment of the participant's acquaintance.

#### Problem awareness

Problem awareness and the other NAM and TPB variables were assessed using the same self-worded instrument from Study 1. The only change was in the items measuring behavioural intentions: Rather than naming *Innocence Canada,* we asked about participants' intentions to join the mailing list and donate to "an organization that fights wrongful imprisonment". Our partner organization *Innocence Canada* was only presented at the end of the study, when assessing actual behaviour, to reduce the risk of participants looking up the organization and engaging in any of the behaviours beforehand.

#### Event experience

To check whether participants were successfully deceived into believing they saw a livestream in real time, we added a scale assessing participants' social and physical sense of presence [@swarbrick2021], measured with 7 items that were rated on a 7-point scale ranging from 1 ("disagree strongly") to 7 ("agree strongly"). Other than in study 1, we asked participants in both conditions (not just for the performance) to describe the stimulus they had seen in up to ten of their own words. Given that participants only saw one of the two stimuli, we abridged the question whether participants liked the order of film and performance. We further added scales measuring aesthetic emotions, immersion, and live music experience, which were assessed for a different research question and will not be analyzed in this study. 

#### Person-level covariates

Because all participants were recruited through Prolific, rather than self-initiatively buying a ticket to the event, we did not ask participants for their motivation to attend, nor for their personal relationship with the researchers or the artists. To shorten the post-survey, we abridged the trait empathy measure, which had not shown consistent associations with supportive behaviour or its predictors in Study 1. In the question about participants' identity, we added an option for religious minorities.

### Analysis

Pre-processing was the same as in study 1, excluding no participants for rushing and excluding `r print(study2_novariance_observations)` out of `r print(study2_total_instrument_observations)` (`r printnum(study2_novariance_observations/study2_total_instrument_observations, digits = 2)`%) responses due to a lack of variance in response patterns (though calculating variance per survey page rather than per instrument). 

To evaluate changes in closeness and empathy towards Anna Vasquez and towards the hypothetical victim and changes in problem awareness, we fitted separate LMMs with stimulus and time as fixed effects and participant as random effect, using the same specifications as in study 1. Given the simpler pre-post-design, baseline ratings were not added as a covariate, but instead reflected one of the two levels of the factor time. As in study 1, the influence of the self-reported outcomes on behavioural intention was evaluated with a multiple linear regression, and the influence of intention on observed behaviour was evaluated with an ordinal logistic regression. To compare the effects of watching one stimulus in study 2 with the effects of watching both stimuli in study 1, we pooled the pre-post data from both studies (disregarding the responses collected at intermission in study 1) and fitted LMMs for the continuous self-reported outcomes with study and time as fixed effects and participant as random effect, and a Wilcoxon rank-sum test for the sum of behaviours participants engaged in. 

## Results

TODO start with paragraph comparing event experience to study 1; report sense of presence

### Awareness

```{r}
#| label: study2-check-correlations
#| include: false
# get names of multiple choice variables
multichoice_vars <- c(grep("^identity", colnames(study2_long), value = TRUE), grep("^experience", colnames(study2_long), value = TRUE))

# recode multiple choice options as dichotomous variables
study1_dichotom <- study1_2long %>%
  mutate(across(all_of(multichoice_vars), ~ replace(.x, is.na(.x), 0))) 

# define control variables
control_vars <- c("age", "familiarity", "liking", "priorknowledge", "demo_openness", "income", "education", "omsi", "politics", multichoice_vars)

# Check correlations with control variables
dv_corr("ios_anna_z", control_vars, study2_dichotom, output = "table") # liking r = .37
dv_corr("ios_target_z", control_vars, study2_dichotom, output = "table") # identity_none r = .34
dv_corr("anna_empathic_concern_z", control_vars, study2_dichotom, output = "table") # liking r = .36
dv_corr("target_empathic_concern_z", control_vars, study2_dichotom, output = "table") # liking r = .34
dv_corr("problem_awareness_z", control_vars, study2_dichotom, output = "table") # identity_lgbq r = .37
dv_corr("behavioural_intention_z", control_vars, study2_dichotom, output = "table") # liking r = .47
dv_corr("behavioural_intention_z", control_vars, subset(study2_dichotom, timepoint == "End"), output = "table") # liking r = .53
dv_corr("behavioural_intention_z", control_vars, subset(study2_dichotom, timepoint == "Baseline"), output = "table") # liking r = .41
dv_corr("sum_behaviour", control_vars, subset(study2_dichotom, timepoint == "End"), method = "spearman", output = "table") # liking r = .69; openness r = .45

rm(study2_dichotom, control_vars, multichoice_vars)
```

```{r} 
#| label: study2-outcome-lmms
#| include: false

# dichotomize covariates
study2_long <- study2_long %>%
  mutate(identity_lgbq_dich = case_when(identity_lgbq == 1 ~ 1,
                                        .default = 0),
         identity_none_dich = case_when(identity_none == 1 ~ 1,
                                        .default = 0),
         # for Bartlett test:
         cell = paste(group, timepoint))

#### Awareness LMM ###

awareness_lmm <- lmer(problem_awareness_z ~ identity_lgbq_dich + group * timepoint + (1|p_id), data = study2_long)
# check_assumptions(awareness_lmm, "problem_awareness_z", study2_long) 
summary(awarenes_lmm)
my_effectsize(awareness_lmm)

#### Anna Empathy LMM ###

anna_empathy_lmm <- lmer(anna_empathic_concern_z ~ liking_z + group * timepoint + (1|p_id), data = study2_long)
check_assumptions(anna_empathy_lmm, "anna_empathic_concern_z", study2_long) # TODO normality of residuals violated
summary(anna_empathy_lmm)
my_effectsize(anna_empathy_lmm)

#### Target Empathy LMM ###

target_empathy_lmm <- lmer(target_empathic_concern_z ~ liking_z + group * timepoint + (1|p_id), data = study2_long)
check_assumptions(target_empathy_lmm, "target_empathic_concern_z", study2_long) # TODO normality of intercepts violated
summary(target_empathy_lmm)
my_effectsize(target_empathy_lmm)

#### Anna Closeness LMM ###

anna_closeness_lmm <- lmer(ios_anna_z ~ liking_z + group * timepoint + (1|p_id), data = study2_long)
check_assumptions(anna_closeness_lmm, "ios_anna_z", study2_long) # TODO rand intercepts just fail shapiro test
summary(anna_closeness_lmm)
my_effectsize(anna_closeness_lmm)

#### Target Closeness LMM ###

target_closeness_lmm <- lmer(ios_target_z ~ identity_none_dich + group * timepoint + (1|p_id), data = study2_long)
check_assumptions(target_closeness_lmm, "ios_target_z", study2_long) # TODO residuals violate normality
summary(target_closeness_lmm)
my_effectsize(target_closeness_lmm)
```

Other than in study 1, openness and political orientation had associations smaller than $r = .3$ with problem awareness and were not included as covariates in the model. However, participants who self-identified with a marginalized sexual orientation tended to have a higher problem awareness (`r apa_print(cor.test(study2_long$problem_awareness_z, study2_long$identity_lgbq_dich, method = "spearman"))$full_result`), hence this variable was controlled for. The model $Awareness \sim LGBQ + Stimulus * Time + (1|Participant)$ yielded a significant effect of xyz, with participants reporting higher problem awareness when xyz (see @fig-awareness).

### Empathy

We fitted two LMMs for empathy with Anna Vasquez and with the hypothetical victim separately. Participants who liked contemporary percussion music more were more empathic with Anna Vasquez (`r apa_print(cor.test(study2_long$anna_empathic_concern_z, study2_long$liking, method = "spearman"))$full_result`) and with the hypothetical victim (`r apa_print(cor.test(study2_long$target_empathic_concern_z, study2_long$liking, method = "spearman"))$full_result`), hence this variable was included as covariate in both models. There was a main effect of xyz on empathy with Anna but not with the hypothetical victim... (see @fig-empathy-2).

```{r}
#| label: fig-empathy-2
#| fig-cap: Empathic Concern with the two targets
#| apa-note: Mean and CI of empathy by stimulus (x-axis), split for ratimgs relating to Anna Vasquez (left) and the hypothetical victim (right). Empathy was rated on a scale ranging from 1 (not at all) to 7 (extremely). Significance levels refer to one-sided pairwise t-tests. $p* < .05$, $** p < .01$, $*** p < .001$, n.s. = not significant.
#| out-width: 100%
#| echo: false
#| warning: false

# TODO add sample size on x-axis
# TODO add significance stars for post-hoc tests

study2_long %>%
  pivot_longer(cols = c(anna_empathic_concern, target_empathic_concern), 
               names_to = "ec_var", 
               values_to = "ec_value") %>%
  mutate(
    order = factor(order, levels = c("Film first", "Perf first")),
    ec_var = factor(ec_var, levels = c("anna_empathic_concern", "target_empathic_concern"), labels = c("Anna Vasquez", "Hypothetical victim")),
    xticks = factor(order, levels = c("Film first", "Perf first"), labels = c("Film", "Performance")),
    # encode which medium comes next for the color of the summary lines
    nextmedium = case_when(
      timepoint == "End" ~ "End",
      (order == "Film first" & timepoint == "Baseline") ~ "Film",
      (order == "Perf first" & timepoint == "Baseline") ~ "Performance"
    ),
    dodge_order = case_when(
      timepoint == "Baseline" ~ as.numeric(order) - .3,
      timepoint == "End" ~ as.numeric(order)
      ),
    jitter_ec = jitter(ec_value, amount = .15)) %>%
plot_meanSE(df = ., dv = "jitter_ec", ylab = "Empathic Concern", xlab = "Stimulus") +
  facet_wrap(vars(ec_var), scales = "free") +
  theme(aspect.ratio = 1.3)
```

### Closeness

As for empathy, we also fitted separate LMMs for the closeness ratings towards the two target persons. Participants who liked contemporary percussion music felt closer to Anna Vasquez (`r apa_print(cor.test(study2_long$ios_anna_z, study2_long$liking, method = "spearman"))$full_result`) and participants who did not identify with any marginalized group felt closer to the hypothetical target (`r apa_print(cor.test(study2_long$ios_target_z, study2_long$identity_none_dich, method = "spearman"))$full_result`), hence these variables were controlled in the respective model. There was a main effect of xyz on closeness with Anna, but not with the target ... (see @fig-closeness-2).


```{r}
#| label: fig-closeness-2
#| fig-cap: Relationship Closeness with the two targets
#| apa-note: Mean and CI of closeness by stimulus (x-axis), split for ratimgs relating to Anna Vasquez (left) and the hypothetical victim (right). Closeness was rated on a visual analog scale ranging from 1 (0% overlap) to 7 (90% overlap). Significance levels refer to one-sided pairwise t-tests. $p* < .05$, $** p < .01$, $*** p < .001$, n.s. = not significant.
#| out-width: 100%
#| echo: false
#| warning: false

# TODO add sample size on x-axis
# TODO add significance stars for post-hoc tests

study2_long %>%
  pivot_longer(cols = c(ios_anna, ios_target), 
               names_to = "ios_var", 
               values_to = "ios_value") %>%
  mutate(
    order = factor(order, levels = c("Film first", "Perf first")),
    ios_var = factor(ios_var, levels = c("ios_anna", "ios_target"), labels = c("Anna Vasquez", "Hypothetical victim")),
    xticks = factor(order, levels = c("Film first", "Perf first"), labels = c("Film", "Performance")),
    # encode which medium comes next for the color of the summary lines
    nextmedium = case_when(
      timepoint == "End" ~ "End",
      (order == "Film first" & timepoint == "Baseline") ~ "Film",
      (order == "Perf first" & timepoint == "Baseline") ~ "Performance"
    ),
    dodge_order = case_when(
      timepoint == "Baseline" ~ as.numeric(order) - .3,
      timepoint == "End" ~ as.numeric(order)
      ),
    jitter_ios = jitter(ios_value, amount = .15)) %>%
plot_meanSE(df = ., dv = "jitter_ios", ylab = "Relationship Closeness", xlab = "Stimulus") +
  facet_wrap(vars(ios_var), scales = "free") +
  theme(aspect.ratio = 1.3)
```

### Charitable Behaviour

Liking contemporary percussion music was also associated with stronger intentions to support a charity fighting wrongful imprisonment at the end of the event (`r apa_print(cor.test(study2_intent$behavioural_intention_z, study2_intent$liking_z, method = "spearman"))$full_result`), and was thus controlled for in the regression $Intention \sim Liking + Closeness (Anna) + Closeness (Victim) + Empathy (Anna) + Empathy (Victim) + Awareness$. Including the intercorrelated closeness and empathy ratings for both target persons lead to heightened variance influence factors, but none exceeded the critical value of 5. Thus, the model did not have problematic multicollinearity. In contrast to study 1, not empathy but problem awareness significantly predicted charitable intentions, with participants who were more aware of wrongful imprisonment reporting higher intentions to support a charity ($\beta = `r printnum(coef(summary(study2_intention_target))["problem_awareness_z", "Estimate"])`$, $t (`r printnum(nobs(study2_intention_target) - summary(study2_intention_target)$fstatistic[2] - 1, digits = 0)`) = `r printnum(coef(summary(study2_intention_target))["problem_awareness_z", "t value"])`$, $p < .001$, $f^2 = `r printnum(awareness_f2)`$). The total explained variance in intention was $R_{adj}^2 = `r printnum(summary(study2_intention_target)$adj.r.squared)`$ (see @tab-regression-intention).

<!-- Run regression of intention twice: once for the film, once for the performance to see whether different factors are predictive? -->

```{r}
#| label: regression-behaviour-intention2
#| echo: false

# z-score predictor
study2_df <- study2_df %>%
  mutate(post_behavioural_intention_z = my_z_score(post_behavioural_intention))

# behaviour ~ intention
study2_sumbehav_intention <- MASS::polr(sum_behaviour_fact ~ post_behavioural_intention_z, data = study2_df, Hess = TRUE)

# store OR values in an object 
study2_sumbehav_intention_OR <- get_OR_CI(study2_sumbehav_intention)

# Compare intention before and after the event
study2_sumbehav_baseintention <- polr(sum_behaviour_fact ~ base_behavioural_intention_z, data = study2_df, Hess = TRUE)

sumbehav_baseintention_OR <- get_OR_CI(study2_sumbehav_baseintention)

r2_nagelkerke(study2_sumbehav_intention)
r2_nagelkerke(study2_sumbehav_baseintention)
```

Looking at actual charitable behaviours in support of the charity *Innocence Canada*, `r sum(study2_df$behaviour_dich, na.rm = T)` (`r printnum(sum(study2_df$behaviour_dich, na.rm = T)/sum(!is.na(study2_df$behaviour_dich))*100)`%) participants performed at least one behaviour: `r sum(study2_df$flyer, na.rm = T)` participants downloaded flyer of the charity, `r sum(study2_df$mailing, na.rm = T)` signed up to their mailing list, and `r sum(study2_df$post_donation, na.rm = T)` made a donation, raising a total of CAD `r sum(study2_df$donation_amount, na.rm = T)` (see @fig-waffle-behaviour). A Wilcoxon rank-sum test revealed that participants who watched the film did/did not perform more behaviours than those who watched the performance (`r apa_print(wilcox.test(sum_behaviour ~ group, data = study2_df))$full_result`). As predicted, participants with higher intentions tended to demonstrate more behaviours (`r paste0("$OR = ", round(study2_sumbehav_intention_OR["post_behavioural_intention_z", "OR"], 2), "$, 95% CI [", round(study2_sumbehav_intention_OR["post_behavioural_intention_z", "CI_lower"], 2), ", ", round(study2_sumbehav_intention_OR["post_behavioural_intention_z", "CI_upper"], 2), "]")`). Intention at the end of the study explained a behavioural variance of $R_{Nagelkerke}^2 = `r printnum(r2_nagelkerke(study2_sumbehav_intention))`$, and thus had more explanatory power than intention at baseline ($R_{Nagelkerke}^2 = `r printnum(r2_nagelkerke(study2_sumbehav_baseintention))`$). 

<!-- Add condition as predictor to the ordinal regression to test film-performance differences in behaviour, rather than with Wilcoxon rank-sum test? -->

### Benefit of watching both stimuli

```{r}
#| label: study1-study2
#| include: false

combined_prepost <- combined_long %>%
  filter(timepoint != "Intermission") %>%
  mutate(timepoint = factor(timepoint, levels = c("Baseline", "End")),
         across(.cols = all_of(c("anna_empathic_concern", "problem_awareness", "behavioural_intention", "ios_anna")), .fns = my_z_score, .names = "{.col}_z"),
         cell = paste(timepoint, study)) # for Bartlett test

contrasts(combined_prepost$timepoint) <- cbind(PostvsPre = c(-1, 1))
contrasts(combined_prepost$study) <- cbind(study1vs2 = c(1, -1))
  
combined_awareness <- lmer(problem_awareness_z ~ timepoint * study + (1|p_id), data = combined_prepost)
check_assumptions(combined_awareness, "problem_awareness_z", combined_prepost) # TODO non-normal residuals

combined_empathy <- lmer(anna_empathic_concern_z ~ timepoint * study + (1|p_id), data = combined_prepost)
check_assumptions(combined_empathy, "anna_empathic_concern_z", combined_prepost) # TODO non-normal residuals and intercepts 

combined_closeness <- lmer(ios_anna_z ~ timepoint * study + (1|p_id), data = combined_prepost)
check_assumptions(combined_closeness, "ios_anna_z", combined_prepost) # TODO all assumptions violated :'(

# compare beahviour between studies, test whether sparsity of livestream participants in study 1 skewes results
wilcox.test(sum_behaviour ~ study, data = combined_prepost, subset = attendance == "Livestream" & timepoint == "End")

wilcox.test(sum_behaviour ~ study, data = combined_prepost, subset = timepoint == "End")
```

To compare the effects of watching one stimulus or both stimuli, we fitted LMMs predicting empathy and closeness (with Anna Vasquez) and problem awareness from time (pre vs. post) and study (study 1 vs. study 2), with random intercepts for participants. For awareness, there was a main effect of xyz... For empathy, study and timepoint interacted ... For closeness, xyz.

\@Lauren does this LMM analysis make sense or is it redundant with study 1, where we already evaluated the effect of one vs. both stimuli?

Participants in study 1 performed more/less/the same amount of behaviours as participants in study 2 (`r apa_print(wilcox.test(sum_behaviour ~ study, data = combined_prepost, subset = attendance == "Livestream" & timepoint == "End"))$full_result`).

## Discussion

# General Discussion

## Displaying Figures

Do you want the tables and figures to be at the end of the document? You can set the `floatsintext` option to false. The reference labels will work no matter where they are in the text.

A reference label for a figure must have the prefix `fig-`, and in a code chunk, the caption must be set with `fig-cap`. Captions are in [title case](https://apastyle.apa.org/style-grammar-guidelines/capitalization/title-case).

```{r}
#| label: fig-myplot
#| fig-cap: The Figure Caption
#| apa-note: This is the note below the figure.
#| fig-height: 2
#| fig-width: 3
ggplot(data.frame(x = c(0, 35)), aes(x)) +
  stat_function(fun = dchisq, 
                args = list(df = 10),
                geom = "area",
                n = 1000,
                color = NA,
                fill = "#41448780") +
  theme_void(base_size = 18)
```

To refer to any figure or table, use the `@` symbol followed by the reference label (e.g., @fig-myplot).

See @fig-appendfig, an example of an imported graphic using markdown syntax.

![Appendix Figure](sampleimage.png){#fig-appendfig apa-note="A *note* below the figure"}

## Displaying Tables

We can make a table the same way as a figure. Generating a table that conforms to APA format in all document formats can be tricky. When the table is simple, the `kable` function from knitr works well. Feel free to experiment with different methods, but I have found that David Gohel's [flextable](https://davidgohel.github.io/flextable/) to be the best option when I need something more complex.

```{r}
#| label: tbl-mytable
#| tbl-cap: The Table Caption. 
#| apa-note: The note below the table.
tibble(Numbers = seq(1,4), Letters = LETTERS[seq(Numbers)]) %>%
  knitr::kable()

```

To refer to this table in text, use the `@` symbol followed by the reference label like so: As seen in @tbl-mytable, the first few numbers and letters of the alphabet are displayed.

## Footnotes

A footnote is usually displayed at the bottom of the page on which the footnote occurs. A short note can be specified with the `^[My note here]` syntax.[^1] A longer note can be specified with the `[^id]` syntax with the text specified on a separate line like so `[^id]: Text here`.[^2]

[^1]: Here is my short footnote!

[^2]: This is a longer footnote. If it has multiple paragraphs, subsequent paragraphs need to be indented with two tabs.

    This paragraph is still part of the footnote because it is indented with two tabs.

A regular paragraph without any indentation is not part of the footnote and will be part of the main body of the document.

## Tables

@tbl-mymarkdowntable2 is an example of a plain markdown table. Note the that the caption begins with a colon.

| Letters | Numbers |
|:-------:|:-------:|
|    A    |    1    |
|    B    |    2    |
|    C    |    3    |

: My Caption. {#tbl-mymarkdowntable2 apa-note="My note"}

# References

<!-- References will auto-populate in the refs div below -->

::: {#refs}
:::

# Detailed sample descriptions {#apx-sampledescription}

TODO

# Technical implementation {#apx-implementation}

## Surveys

All surveys were coded in jsPsych [@leeuw2023] and hosted through JATOS [@lange2015] on our lab server located at McMaster University, and managed by McMaster’s Research and High Performance Computing Support. Codebooks and print versions are available at https://doi.org/10.5281/zenodo.15282949. All participants completed the survey via web browser: In-person participants were provided with LIVELab's Samsung Galaxy Tab A 8.0 SM-T380 tablets, which they could store in a pouch attached to their seat during the event. Livestream participants used their own machines. Since this was a live event, participants had limited time to fill out the surveys before the event and at intermission so as not to delay the performance and the film screening. To ensure that participants progressed through the surveys as planned, we monitored the incoming data using the JATOS logs. If participants did not complete the surveys in the designated time, we skipped the remaining questions so that the surveys would not distract participants from the event. For in-person participants, research assistants went up to their seats and manually skipped the remaining survey questions, whereas for livestream participants, we signaled the JATOS server to move every participant to the livestream once the first and second half of the event began, respectively.

## Physiological measures

Both in-person and online participants consented to eye-tracking and cardiac monitoring. In-person participants were equipped with Bangle.js 2 watches collecting a photoplethysmogram signal [@flannery2024], and with Pupil Labs' NEON eye-tracking glasses, controlled via a multi-person mobile eye-tracking system [@saxena2025]. Livestream participants were recorded via webcam to extract their eye-movements and cardiac activity post-hoc. The calibration for the eye-tracking glasses is described in @saxena2025 and the calibration for the webcam is described in @saxena2023.

## Environment

The LIVELab is equipped with technology that meets the demands of concert halls as well as psychological laboratories. It has a capacity of 106 seats. For this study, in-person participants were seated in the second, third and fourth front rows. Including participants, the event was attended by 55 in-person audience members on April 2nd and 60 audience members on April 4th. The performance took place on the stage, where the sound was recorded by eight microphones for the different instruments and two microphones for the audience (e.g., to capture applause), and presented over a PA system consisting of two Meyer 500HP subwoofers and 5 Meyer UPJ-1P speakers. For the livestream, the performance was filmed from a static PTZOptics pt30x-sdi-g2 camera positioned behind and above the audience seating to capture an unobstructed view of the stage. The livestream audio was the same mix presented in the concert hall. The film was screened for the in-person audience on a 384.5 cm x 216 cm Samsung LH015IER LED video wall, using the same PA sound system. The film video and audio were streamed directly to YouTube. For livestream participants, the stream was presented in the jsPsych environment using the AVOKE plugin \[TODO cite\].

# Event Experience {#apx-eventexperience}

TODO

# Model Comparisons {#apx-modelcomps}

TODO expand this appendix to include the full output for each model.

```{r} 
#| label: model-comp
#| tbl-cap: Model comparison results for the three outcomes
#| apa-note: Base Model - Baseline covariate Model. LRT Test - Likelihood Ratio Test. $^a$The model violated the assumption of normally distributed random intercepts, but neither log-transformation nor exclusions could restore normality. $^b$Two observations with extreme residuals were excluded to preserve the assumptions of normally distributed residuals and/or random intercepts.
#| output: asis

# create table object
model_comp_table <- matrix(ncol = 2, nrow = 0) %>% # initiate table structure
  rbind(c("Closeness$^a$", paste0("$N_{observations} = ", nobs(closeness_lmm), "$; $N_{participants} = ", closeness_lmm@Gp[2], "$"))) %>% 
  rbind(c("  Base Model", "Closeness \\textasciitilde Baseline + (1|Participant)")) %>%
  rbind(c("  Full Model", "Closeness \\textasciitilde Baseline + Attendance * Stimulus * Time + (1|Participant)")) %>%
  rbind(c("  LRT Test", model_comp(closeness_cov, closeness_lmm))) %>%
  rbind(c("", "")) %>%
  rbind(c("Empathy$^b$", paste0("$N_{observations} = ", nobs(empathy_lmm), "$; $N_{participants} = ", empathy_lmm@Gp[2], "$"))) %>%
  rbind(c("  Base Model", "Empathy \\textasciitilde Baseline + (1|Participant)")) %>%
  rbind(c("  Full Model", "Empathy \\textasciitilde Baseline + Attendance * Stimulus * Time + (1|Participant)")) %>%
  rbind(c("  LRT Test", model_comp(empathy_cov, empathy_lmm))) %>%
  rbind(c("", "")) %>%
  rbind(c("Awareness$^b$", paste0("$N_{observations} = ", nobs(awareness_lmm), "$; $N_{participants} = ", awareness_lmm@Gp[2], "$"))) %>%
  rbind(c("  Base Model", "Awareness \\textasciitilde Openness + Politics + Baseline + (1|Participant)")) %>%
  rbind(c("  Full Model", "Awareness \\textasciitilde Openness + Politics + Baseline + Attendance * Stimulus * Time + (1|Participant)")) %>%
  rbind(c("  LRT Test", model_comp(awareness_cov, awareness_lmm)))
  
# set colnames
colnames(model_comp_table) <- c("Model/Test", "Formula/Statistic")
  
# print as apa-formatted table
apa_table(
  model_comp_table,
  # caption = "Model comparison results for the three outcomes.",
  align = c("l", "l"),
  # note = 'Base Model - Baseline covariate Model. LRT Test - Likelihood Ratio Test. $^a$The model violated the assumption of normally distributed random intercepts, but neither log-transformation nor exclusions could restore normality. $^b$Two observations with extreme residuals were excluded to preserve the assumptions of normally distributed residuals and/or random intercepts.',
  escape = FALSE
)
```
